<!doctype html>
<html lang="fr">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LS4YOU Parcours Comp√©tences</title>
  <script src="/_sdk/data_sdk.js"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Poppins', 'Montserrat', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #46D9D2 0%, #FF4F73 100%);
      min-height: 100%;
      width: 100%;
    }

    * {
      box-sizing: border-box;
    }

    .app-container {
      width: 100%;
      min-height: 100%;
      padding: 24px 16px;
    }

    .header {
      text-align: center;
      margin-bottom: 32px;
      animation: fadeIn 0.6s ease-out;
    }

    .header-content {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 16px;
      flex-wrap: wrap;
      margin-bottom: 8px;
    }

    .logo-left {
      height: 50px;
      width: auto;
    }

    .logo-right {
      height: 50px;
      width: auto;
    }

    .main-title {
      font-size: 32px;
      font-weight: 800;
      color: #FFFFFF;
      margin: 0;
      text-shadow: 2px 2px 8px rgba(0,0,0,0.2);
    }

    .subtitle {
      font-size: 16px;
      color: #FFFFFF;
      opacity: 0.95;
      margin: 0;
      font-weight: 500;
    }

    .navigation {
      display: flex;
      gap: 12px;
      margin-bottom: 24px;
      overflow-x: auto;
      padding: 4px;
      animation: slideUp 0.8s ease-out;
    }

    .axis-button {
      flex-shrink: 0;
      padding: 12px 20px;
      background: rgba(255, 255, 255, 0.95);
      border: 3px solid transparent;
      border-radius: 24px;
      font-size: 14px;
      font-weight: 700;
      color: #1a1a1a;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    .axis-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0,0,0,0.2);
    }

    .axis-button.active {
      background: #FFD75B;
      border-color: #FF4F73;
      transform: scale(1.05);
    }

    .content-area {
      background: #FFFFFF;
      border-radius: 24px;
      padding: 24px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.15);
      animation: fadeIn 0.5s ease-out;
    }

    .axis-title {
      font-size: 28px;
      font-weight: 800;
      color: #171718;
      margin: 0 0 24px 0;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .competency-card {
      border-radius: 20px;
      padding: 20px;
      margin-bottom: 16px;
      border: 2px solid #e9ecef;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .competency-card:hover {
      transform: translateX(4px);
      box-shadow: 0 4px 16px rgba(70, 217, 210, 0.3);
    }

    .competency-card:nth-child(odd) {
      background: linear-gradient(135deg, #46D9D2 0%, #3bc5be 100%);
    }

    .competency-card:nth-child(even) {
      background: linear-gradient(135deg, #FF4F73 0%, #e64565 100%);
    }

    .competency-card:nth-child(3n) {
      background: linear-gradient(135deg, #FFD75B 0%, #ffc940 100%);
    }

    .competency-title {
      font-size: 18px;
      font-weight: 700;
      color: #FFFFFF;
      margin: 0 0 12px 0;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .activity-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 12px;
    }

    .activity-button {
      background: #FFFFFF;
      border: 2px solid #FFFFFF;
      border-radius: 16px;
      padding: 12px 16px;
      font-size: 14px;
      font-weight: 600;
      color: #171718;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: left;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .activity-button:hover {
      background: rgba(255, 255, 255, 0.9);
      transform: scale(1.02);
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .activity-button.completed {
      background: #FFD75B;
      border-color: #FFD75B;
      color: #171718;
      font-weight: 700;
    }

    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.7);
      z-index: 1000;
      align-items: center;
      justify-content: center;
      padding: 16px;
      animation: fadeIn 0.3s ease-out;
    }

    .modal.active {
      display: flex;
    }

    .modal-content {
      background: #FFFFFF;
      border-radius: 24px;
      padding: 32px 24px;
      max-width: 600px;
      width: 100%;
      max-height: 90%;
      overflow-y: auto;
      position: relative;
      animation: slideUp 0.4s ease-out;
    }

    .close-button {
      position: absolute;
      top: 16px;
      right: 16px;
      background: #FF4F73;
      color: #FFFFFF;
      border: none;
      border-radius: 50%;
      width: 36px;
      height: 36px;
      font-size: 20px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }

    .close-button:hover {
      transform: rotate(90deg);
      background: #e64565;
    }

    .activity-title {
      font-size: 24px;
      font-weight: 800;
      color: #171718;
      margin: 0 0 24px 0;
      text-align: center;
    }

    .flip-card-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 16px;
      margin: 24px 0;
    }

    .flip-card {
      height: 140px;
      perspective: 1000px;
      cursor: pointer;
    }

    .flip-card-inner {
      position: relative;
      width: 100%;
      height: 100%;
      transition: transform 0.6s;
      transform-style: preserve-3d;
    }

    .flip-card.flipped .flip-card-inner {
      transform: rotateY(180deg);
    }

    .flip-card-front, .flip-card-back {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      border-radius: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 16px;
      text-align: center;
    }

    .flip-card-front {
      background: linear-gradient(135deg, #46D9D2 0%, #3bc5be 100%);
      color: white;
      font-weight: 700;
      font-size: 15px;
    }

    .flip-card-back {
      background: linear-gradient(135deg, #FFD75B 0%, #ffc940 100%);
      transform: rotateY(180deg);
    }

    .emoji-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 12px;
      margin: 24px 0;
    }

    .emoji-card {
      background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
      border: 3px solid #e9ecef;
      border-radius: 20px;
      padding: 20px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 48px;
    }

    .emoji-card:hover {
      transform: scale(1.05);
      border-color: #46D9D2;
      box-shadow: 0 8px 24px rgba(70, 217, 210, 0.3);
    }

    .emoji-card.selected {
      background: linear-gradient(135deg, #FFD75B 0%, #ffc940 100%);
      border-color: #FF4F73;
      transform: scale(1.05);
    }

    .options-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin: 20px 0;
    }

    .option-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 16px;
      background: #f8f9fa;
      border-radius: 16px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .option-item:hover {
      background: #e9ecef;
      transform: translateX(4px);
    }

    .option-item.selected {
      background: #46D9D2;
      color: #FFFFFF;
    }

    .checkbox {
      width: 24px;
      height: 24px;
      border: 3px solid #46D9D2;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      transition: all 0.3s ease;
    }

    .option-item.selected .checkbox {
      background: #FFFFFF;
      border-color: #FFFFFF;
    }

    .checkbox::after {
      content: '‚úì';
      font-size: 18px;
      font-weight: 900;
      color: #46D9D2;
      display: none;
    }

    .option-item.selected .checkbox::after {
      display: block;
    }

    .text-input {
      width: 100%;
      padding: 16px;
      border: 3px solid #e9ecef;
      border-radius: 16px;
      font-size: 16px;
      font-family: inherit;
      transition: all 0.3s ease;
      margin: 12px 0;
    }

    .text-input:focus {
      outline: none;
      border-color: #46D9D2;
      box-shadow: 0 0 0 4px rgba(70, 217, 210, 0.1);
    }

    .button-primary {
      width: 100%;
      padding: 16px 32px;
      background: linear-gradient(135deg, #FF4F73 0%, #e64565 100%);
      color: #FFFFFF;
      border: none;
      border-radius: 16px;
      font-size: 16px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-top: 16px;
      box-shadow: 0 4px 12px rgba(255, 79, 115, 0.3);
    }

    .button-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(255, 79, 115, 0.4);
    }

    .button-primary:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    .button-secondary {
      width: 100%;
      padding: 16px 32px;
      background: #FFFFFF;
      color: #46D9D2;
      border: 3px solid #46D9D2;
      border-radius: 16px;
      font-size: 16px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-top: 12px;
    }

    .button-secondary:hover {
      background: #46D9D2;
      color: #FFFFFF;
    }

    .progress-indicator {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin: 24px 0;
    }

    .progress-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: #e9ecef;
      transition: all 0.3s ease;
    }

    .progress-dot.active {
      background: #FF4F73;
      transform: scale(1.3);
    }

    .slider-container {
      margin: 32px 0;
      padding: 24px;
      background: #f8f9fa;
      border-radius: 20px;
    }

    .slider-track {
      position: relative;
      height: 8px;
      background: #e9ecef;
      border-radius: 4px;
      margin: 40px 0;
    }

    .slider-thumb {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 32px;
      height: 32px;
      background: linear-gradient(135deg, #FF4F73 0%, #e64565 100%);
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(255, 79, 115, 0.4);
      transition: all 0.2s ease;
    }

    .slider-thumb:hover {
      transform: translate(-50%, -50%) scale(1.2);
    }

    .slider-labels {
      display: flex;
      justify-content: space-between;
      font-size: 12px;
      font-weight: 600;
      color: #6c757d;
      margin-top: 12px;
    }

    .drag-columns {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 16px;
      margin: 24px 0;
    }

    .drag-column {
      background: #f8f9fa;
      border: 3px dashed #46D9D2;
      border-radius: 20px;
      padding: 16px;
      min-height: 200px;
    }

    .column-header {
      font-size: 16px;
      font-weight: 700;
      color: #1a1a1a;
      margin-bottom: 12px;
      text-align: center;
    }

    .draggable-item {
      padding: 12px 16px;
      background: #FFFFFF;
      border: 3px solid #46D9D2;
      border-radius: 16px;
      font-size: 14px;
      font-weight: 700;
      color: #171718;
      cursor: move;
      transition: all 0.3s ease;
      user-select: none;
      margin-bottom: 8px;
    }

    .draggable-item:hover {
      transform: scale(1.05);
      box-shadow: 0 4px 12px rgba(70, 217, 210, 0.3);
    }

    .draggable-item.dragging {
      opacity: 0.5;
    }

    .image-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      margin: 24px 0;
    }

    .image-card {
      aspect-ratio: 1;
      background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
      border: 3px solid #e9ecef;
      border-radius: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-size: 48px;
      cursor: pointer;
      transition: all 0.3s ease;
      padding: 12px;
    }

    .image-card:hover {
      transform: scale(1.05);
      border-color: #46D9D2;
    }

    .image-card.selected {
      border-color: #FF4F73;
      background: linear-gradient(135deg, #FFD75B 0%, #ffc940 100%);
      transform: scale(1.05);
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
      }
      to {
        opacity: 1;
      }
    }

    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @media (max-width: 768px) {
      .main-title {
        font-size: 28px;
      }

      .subtitle {
        font-size: 14px;
      }

      .axis-title {
        font-size: 24px;
      }

      .modal-content {
        padding: 24px 16px;
      }

      .drag-columns {
        grid-template-columns: 1fr;
      }

      .image-grid {
        grid-template-columns: repeat(3, 1fr);
      }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="app-container">
   <header class="header">
    <div class="header-content"><img src="https://static.wixstatic.com/media/dd5dab_47743b1c86024865ba19e623a3db327f~mv2.avif/v1/fill/w_224,h_60,al_c,q_80,enc_avif,quality_auto/dd5dab_47743b1c86024865ba19e623a3db327f~mv2.avif" alt="Erasmus+ Logo" class="logo-left" onerror="this.style.display='none';">
     <h1 class="main-title" id="mainTitle">Mon Parcours LS4YOU</h1><img src="https://www.lifeskills4youth.eu/wp-content/uploads/2024/07/LS4YOU_Logo.png" alt="LS4YOU Logo" class="logo-right" onerror="this.style.display='none';">
    </div>
    <p class="subtitle" id="subtitle">D√©veloppe tes comp√©tences √† ton rythme</p>
   </header>
   <nav class="navigation" id="axisNav"></nav>
   <main class="content-area" id="contentArea"></main>
   <div class="modal" id="activityModal">
    <div class="modal-content" id="modalContent"><button class="close-button" id="closeModal">‚úï</button>
     <div id="activityContent"></div>
    </div>
   </div>
  </div>
  <script>
    const defaultConfig = {
      main_title: "Mon Parcours LS4YOU",
      subtitle: "D√©veloppe tes comp√©tences √† ton rythme"
    };

    const axesData = [
      {
        id: 1,
        name: "PERSONNALIT√â",
        emoji: "‚≠ê",
        competencies: [
          {
            id: 1,
            name: "Conscience de soi",
            emoji: "üéØ",
            activities: [
              { id: "emoji-check", name: "Comment je me sens ?" },
              { id: "reaction-auto", name: "Ma r√©action automatique" }
            ]
          },
          {
            id: 2,
            name: "Identit√© & Valeurs",
            emoji: "üíé",
            activities: [
              { id: "values-selector", name: "Ce qui compte pour moi" },
              { id: "moi-autres", name: "Moi / Les autres" }
            ]
          },
          {
            id: 3,
            name: "Motivation & Sens",
            emoji: "üöÄ",
            activities: [
              { id: "moodboard", name: "Ce qui me motive" },
              { id: "action-321", name: "3-2-1 Action" }
            ]
          },
          {
            id: 4,
            name: "Prise de d√©cision",
            emoji: "‚öñÔ∏è",
            activities: [
              { id: "avantages-inconvenients", name: "Avantages / Inconv√©nients" },
              { id: "feu-tricolore", name: "Le feu du choix" }
            ]
          },
          {
            id: 5,
            name: "Auto-r√©gulation",
            emoji: "üßò",
            activities: [
              { id: "pause-respiration", name: "Pause 10 secondes" },
              { id: "a-chaud-a-froid", name: "√Ä chaud / √Ä froid" }
            ]
          }
        ]
      },
      {
        id: 2,
        name: "VALORISATION DE SOI",
        emoji: "‚ú®",
        competencies: [
          {
            id: 1,
            name: "Estime de soi r√©aliste",
            emoji: "üåü",
            activities: [
              { id: "mini-reussites", name: "Mes 3 mini-r√©ussites" },
              { id: "je-progresse", name: "Je progresse quand..." }
            ]
          },
          {
            id: 2,
            name: "Communication & expression",
            emoji: "üí¨",
            activities: [
              { id: "dire-en-images", name: "Dire ce que je veux en 3 images" },
              { id: "ami-conseiller-employeur", name: "Ami / Conseiller / Employeur" }
            ]
          },
          {
            id: 3,
            name: "Personal branding",
            emoji: "üéØ",
            activities: [
              { id: "vie-competences", name: "Ma vie = comp√©tences" },
              { id: "pitch-20s", name: "Mon pitch 20 secondes" }
            ]
          },
          {
            id: 4,
            name: "Comp√©tences sociales",
            emoji: "üë•",
            activities: [
              { id: "signaux-sociaux", name: "Je rep√®re les signaux sociaux" },
              { id: "gerer-desaccord", name: "GÔøΩÔøΩrer un d√©saccord simple" }
            ]
          },
          {
            id: 5,
            name: "Positionnement / affirmation",
            emoji: "üí™",
            activities: [
              { id: "dire-oui-non", name: "Dire OUI / dire NON" },
              { id: "mes-limites", name: "Mes limites en 3 phrases" }
            ]
          }
        ]
      },
      {
        id: 3,
        name: "BIEN-√äTRE",
        emoji: "üåø",
        competencies: [
          {
            id: 1,
            name: "Hygi√®ne de vie & √©nergie",
            emoji: "‚ö°",
            activities: [
              { id: "batterie-jour", name: "Ma batterie du jour" },
              { id: "epuise-recharge", name: "√áa m'√©puise / √ßa me recharge" }
            ]
          },
          {
            id: 2,
            name: "Gestion du stress & √©motions",
            emoji: "üßò",
            activities: [
              { id: "stress-moment", name: "Mon stress du moment" },
              { id: "pause-30s", name: "Ma pause 30 secondes" }
            ]
          },
          {
            id: 3,
            name: "R√©silience & capacit√© √† rebondir",
            emoji: "üí™",
            activities: [
              { id: "deja-surmonte", name: "Ce que j'ai d√©j√† surmont√©" },
              { id: "plan-micro-reprise", name: "Plan micro-reprise" }
            ]
          },
          {
            id: 4,
            name: "S√©curit√© int√©rieure",
            emoji: "üõ°Ô∏è",
            activities: [
              { id: "lieu-securite", name: "Mon lieu / moment s√©curit√©" },
              { id: "qui-parler", name: "√Ä qui je peux parler ?" }
            ]
          },
          {
            id: 5,
            name: "Transversal bien-√™tre",
            emoji: "üåà",
            activities: [
              { id: "signal-alerte", name: "Mon signal d'alerte" },
              { id: "ressources-bien-etre", name: "Mes 3 ressources bien-√™tre" }
            ]
          }
        ]
      },
      {
        id: 4,
        name: "RESSOURCES",
        emoji: "üíº",
        competencies: [
          {
            id: 1,
            name: "Gestion de l'argent & budget",
            emoji: "üí∞",
            activities: [
              { id: "priorites-mois", name: "Mes 3 priorit√©s du mois" },
              { id: "entrees-sorties", name: "√áa rentre / √áa sort" }
            ]
          },
          {
            id: 2,
            name: "Logement & mobilit√©",
            emoji: "üè†",
            activities: [
              { id: "trajet-sans-galere", name: "Mon trajet sans gal√®re" },
              { id: "lieu-bien-etre", name: "Mon lieu o√π je me sens bien" }
            ]
          },
          {
            id: 3,
            name: "Acc√®s aux droits & d√©marches",
            emoji: "üìã",
            activities: [
              { id: "mes-droits", name: "Mes droits du moment" },
              { id: "demarche-3-etapes", name: "1 d√©marche = 3 √©tapes" }
            ]
          },
          {
            id: 4,
            name: "√âquipement & num√©rique",
            emoji: "üì±",
            activities: [
              { id: "equipement-base", name: "Mon √©quipement de base" },
              { id: "ressources-numeriques", name: "Mes ressources num√©riques" },
              { id: "kit-minimum", name: "Mon kit minimum" },
              { id: "ou-trouver", name: "O√π je peux trouver √ßa ?" }
            ]
          },
          {
            id: 5,
            name: "Transversal ressources",
            emoji: "üîß",
            activities: [
              { id: "gerer-imprevu", name: "Je g√®re un impr√©vu" },
              { id: "ressources-solides", name: "Mes 3 ressources solides" }
            ]
          }
        ]
      },

    ];

    let currentAxis = 1;
    let currentActivity = null;
    let activityState = {};
    let completedActivities = new Set();

    const dataHandler = {
      onDataChanged(data) {
        completedActivities.clear();
        data.forEach(record => {
          if (record.activity_id) {
            completedActivities.add(record.activity_id);
          }
        });
        if (currentAxis) {
          renderAxisContent(currentAxis);
        }
      }
    };

    async function initializeApp() {
      const initResult = await window.dataSdk.init(dataHandler);
      if (!initResult.isOk) {
        console.error("Failed to initialize data SDK");
      }
      
      renderAxisNavigation();
      renderAxisContent(currentAxis);
      setupEventListeners();
    }

    function renderAxisNavigation() {
      const nav = document.getElementById('axisNav');
      nav.innerHTML = axesData.map(axis => `
        <button class="axis-button ${axis.id === currentAxis ? 'active' : ''}" data-axis="${axis.id}">
          ${axis.emoji} Axe ${axis.id}
        </button>
      `).join('');
    }

    function renderAxisContent(axisId) {
      currentAxis = axisId;
      const axis = axesData.find(a => a.id === axisId);
      const content = document.getElementById('contentArea');
      
      renderAxisNavigation();
      
      content.innerHTML = `
        <h2 class="axis-title">${axis.emoji} Axe ${axis.id} ‚Äì ${axis.name}</h2>
        ${axis.competencies.map(comp => `
          <div class="competency-card">
            <h3 class="competency-title">${comp.emoji} ${comp.name}</h3>
            <div class="activity-list">
              ${comp.activities.map(activity => {
                const isCompleted = completedActivities.has(activity.id);
                return `
                  <button class="activity-button ${isCompleted ? 'completed' : ''}" 
                          data-activity="${activity.id}" 
                          data-axis="${axis.id}" 
                          data-comp="${comp.id}">
                    <span>${activity.name}</span>
                    <span>${isCompleted ? '‚úì' : '‚Üí'}</span>
                  </button>
                `;
              }).join('')}
            </div>
          </div>
        `).join('')}
      `;
    }

    function setupEventListeners() {
      document.getElementById('axisNav').addEventListener('click', (e) => {
        if (e.target.classList.contains('axis-button')) {
          const axisId = parseInt(e.target.dataset.axis);
          renderAxisContent(axisId);
        }
      });

      document.getElementById('contentArea').addEventListener('click', (e) => {
        const button = e.target.closest('.activity-button');
        if (button) {
          const activityId = button.dataset.activity;
          const axisId = parseInt(button.dataset.axis);
          const compId = parseInt(button.dataset.comp);
          openActivity(activityId, axisId, compId);
        }
      });

      document.getElementById('closeModal').addEventListener('click', closeModal);
      
      document.getElementById('activityModal').addEventListener('click', (e) => {
        if (e.target.id === 'activityModal') {
          closeModal();
        }
      });
    }

    function openActivity(activityId, axisId, compId) {
      currentActivity = { id: activityId, axisId, compId };
      activityState = { step: 1, responses: {} };
      
      const modal = document.getElementById('activityModal');
      modal.classList.add('active');
      
      renderActivity(activityId);
    }

    function closeModal() {
      const modal = document.getElementById('activityModal');
      modal.classList.remove('active');
      currentActivity = null;
      activityState = {};
    }

    function renderActivity(activityId) {
      const content = document.getElementById('activityContent');
      
      switch(activityId) {
        // AXES 1-3: Existing activities... (keeping all previous activities)
        case 'emoji-check':
          renderEmojiCheck();
          break;
        case 'reaction-auto':
          renderReactionAuto();
          break;
        case 'values-selector':
          renderValuesSelector();
          break;
        case 'moi-autres':
          renderMoiAutres();
          break;
        case 'moodboard':
          renderMoodboard();
          break;
        case 'action-321':
          renderAction321();
          break;
        case 'avantages-inconvenients':
          renderAvantagesInconvenients();
          break;
        case 'feu-tricolore':
          renderFeuTricolore();
          break;
        case 'pause-respiration':
          renderPauseRespiration();
          break;
        case 'a-chaud-a-froid':
          renderAChaudAFroid();
          break;
        case 'mini-reussites':
          renderMiniReussites();
          break;
        case 'je-progresse':
          renderJeProgresse();
          break;
        case 'dire-en-images':
          renderDireEnImages();
          break;
        case 'ami-conseiller-employeur':
          renderAmiConseillerEmployeur();
          break;
        case 'vie-competences':
          renderVieCompetences();
          break;
        case 'pitch-20s':
          renderPitch20s();
          break;
        case 'signaux-sociaux':
          renderSignauxSociaux();
          break;
        case 'gerer-desaccord':
          renderGererDesaccord();
          break;
        case 'dire-oui-non':
          renderDireOuiNon();
          break;
        case 'mes-limites':
          renderMesLimites();
          break;
        case 'batterie-jour':
          renderBatterieJour();
          break;
        case 'epuise-recharge':
          renderEpuiseRecharge();
          break;
        case 'stress-moment':
          renderStressMoment();
          break;
        case 'pause-30s':
          renderPause30s();
          break;
        case 'deja-surmonte':
          renderDejaSurmonte();
          break;
        case 'plan-micro-reprise':
          renderPlanMicroReprise();
          break;
        case 'lieu-securite':
          renderLieuSecurite();
          break;
        case 'qui-parler':
          renderQuiParler();
          break;
        case 'signal-alerte':
          renderSignalAlerte();
          break;
        case 'ressources-bien-etre':
          renderRessourcesBienEtre();
          break;
        // NEW AXE 4 ACTIVITIES
        case 'priorites-mois':
          renderPrioritesMois();
          break;
        case 'entrees-sorties':
          renderEntreesSorties();
          break;
        case 'trajet-sans-galere':
          renderTrajetSansGalere();
          break;
        case 'lieu-bien-etre':
          renderLieuBienEtre();
          break;
        case 'mes-droits':
          renderMesDroits();
          break;
        case 'demarche-3-etapes':
          renderDemarche3Etapes();
          break;
        case 'equipement-base':
          renderEquipementBase();
          break;
        case 'ressources-numeriques':
          renderRessourcesNumeriques();
          break;
        case 'kit-minimum':
          renderKitMinimum();
          break;
        case 'ou-trouver':
          renderOuTrouver();
          break;
        case 'gerer-imprevu':
          renderGererImprevu();
          break;
        case 'ressources-solides':
          renderRessourcesSolides();
          break;
        default:
          renderDefaultActivity();
      }
    }

    // ===== PLACEHOLDER: ALL AXE 1, 2, 3 FUNCTIONS =====
    // (Keeping all previous renderXXX functions - not rewriting them here for brevity)
    // These would include: renderEmojiCheck, renderReactionAuto, renderValuesSelector, etc.
    // For the sake of this response, I'll assume they exist and jump to the NEW Axe 4 activities

    // ===== AXE 1 - PERSONNALIT√â =====
    
    function renderEmojiCheck() {
      const content = document.getElementById('activityContent');
      const emojis = [
        { emoji: 'üòä', label: 'Content' },
        { emoji: 'üòî', label: 'Triste' },
        { emoji: 'üò§', label: '√ânerv√©' },
        { emoji: 'üò∞', label: 'Stress√©' },
        { emoji: 'üò¥', label: 'Fatigu√©' },
        { emoji: 'ü§î', label: 'Perplexe' }
      ];
      
      content.innerHTML = `
        <h2 class="activity-title">Comment je me sens ?</h2>
        <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 32px;">
          Choisis l'√©motion qui correspond √† ton √©tat actuel
        </p>
        <div class="emoji-grid">
          ${emojis.map(item => `
            <div class="emoji-card" data-emoji="${item.label}">
              ${item.emoji}
              <div style="font-size: 14px; font-weight: 700; margin-top: 12px; color: #1a1a1a;">
                ${item.label}
              </div>
            </div>
          `).join('')}
        </div>
        <p style="font-size: 16px; font-weight: 700; margin: 24px 0;">
          Pourquoi je me sens comme √ßa ?
        </p>
        <textarea class="text-input" rows="4" placeholder="Explique en quelques mots..." id="emotionReason"></textarea>
        <button class="button-primary" id="finishActivity">Terminer</button>
      `;
      
      let selectedEmotion = '';
      
      content.querySelectorAll('.emoji-card').forEach(card => {
        card.addEventListener('click', () => {
          content.querySelectorAll('.emoji-card').forEach(c => c.classList.remove('selected'));
          card.classList.add('selected');
          selectedEmotion = card.dataset.emoji;
        });
      });
      
      content.querySelector('#finishActivity').addEventListener('click', async () => {
        activityState.responses.emotion = selectedEmotion;
        activityState.responses.reason = document.getElementById('emotionReason').value;
        await saveActivity();
      });
    }

    function renderReactionAuto() {
      const content = document.getElementById('activityContent');
      
      if (activityState.step === 1) {
        content.innerHTML = `
          <h2 class="activity-title">Ma r√©action automatique</h2>
          <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 32px;">
            Quand quelqu'un me contrarie, ma premi√®re r√©action c'est :
          </p>
          <div class="options-list">
            <div class="option-item" data-reaction="colere">
              <div class="checkbox"></div>
              <span>üò§ Je me mets en col√®re</span>
            </div>
            <div class="option-item" data-reaction="silence">
              <div class="checkbox"></div>
              <span>ü§ê Je me tais et j'encaisse</span>
            </div>
            <div class="option-item" data-reaction="fuite">
              <div class="checkbox"></div>
              <span>üèÉ Je pars / je fuis la situation</span>
            </div>
            <div class="option-item" data-reaction="discussion">
              <div class="checkbox"></div>
              <span>üí¨ J'essaie d'en parler calmement</span>
            </div>
          </div>
          <button class="button-primary" id="nextStep">Suivant</button>
        `;
        
        let selectedReaction = '';
        
        content.querySelectorAll('.option-item').forEach(item => {
          item.addEventListener('click', () => {
            content.querySelectorAll('.option-item').forEach(i => i.classList.remove('selected'));
            item.classList.add('selected');
            selectedReaction = item.dataset.reaction;
          });
        });
        
        content.querySelector('#nextStep').addEventListener('click', () => {
          activityState.responses.reaction = selectedReaction;
          activityState.step = 2;
          renderReactionAuto();
        });
      } else if (activityState.step === 2) {
        content.innerHTML = `
          <h2 class="activity-title">Et apr√®s ?</h2>
          <p style="font-size: 16px; font-weight: 700; margin: 24px 0;">
            Cette r√©action m'aide ou me complique la vie ?
          </p>
          <textarea class="text-input" rows="5" placeholder="Explique ce qui se passe apr√®s..." id="reactionImpact"></textarea>
          <button class="button-primary" id="finishActivity">Terminer</button>
        `;
        
        content.querySelector('#finishActivity').addEventListener('click', async () => {
          activityState.responses.impact = document.getElementById('reactionImpact').value;
          await saveActivity();
        });
      }
    }

    function renderValuesSelector() {
      const content = document.getElementById('activityContent');
      
      if (activityState.step === 1) {
        const values = [
          'ü§ù Solidarit√©', 'üéØ R√©ussite', 'ÔøΩÔøΩÔøΩ‚Äçüë©‚Äçüëß Famille', 'üí∞ Argent',
          'üé® Cr√©ativit√©', '‚öñÔ∏è Justice', 'üåç Nature', 'üéâ Plaisir',
          'üìö Connaissance', 'üí™ Force', '‚ù§Ô∏è Amour', 'üîí S√©curit√©'
        ];
        
        activityState.selectedValues = activityState.selectedValues || [];
        
        content.innerHTML = `
          <h2 class="activity-title">Ce qui compte pour moi</h2>
          <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 20px;">
            Choisis 3 valeurs importantes pour toi (${activityState.selectedValues.length}/3)
          </p>
          <div class="options-list">
            ${values.map(value => `
              <div class="option-item ${activityState.selectedValues.includes(value) ? 'selected' : ''}" 
                   data-value="${value}">
                <div class="checkbox"></div>
                <span>${value}</span>
              </div>
            `).join('')}
          </div>
          <button class="button-primary" id="nextStep" ${activityState.selectedValues.length !== 3 ? 'disabled' : ''}>
            Suivant
          </button>
        `;
        
        content.querySelectorAll('.option-item').forEach(item => {
          item.addEventListener('click', () => {
            const value = item.dataset.value;
            const selected = activityState.selectedValues || [];
            
            if (item.classList.contains('selected')) {
              item.classList.remove('selected');
              activityState.selectedValues = selected.filter(v => v !== value);
            } else if (selected.length < 3) {
              item.classList.add('selected');
              activityState.selectedValues = [...selected, value];
            }
            
            renderValuesSelector();
          });
        });
        
        if (activityState.selectedValues.length === 3) {
          content.querySelector('#nextStep').addEventListener('click', () => {
            activityState.responses.values = activityState.selectedValues;
            activityState.step = 2;
            renderValuesSelector();
          });
        }
      } else if (activityState.step === 2) {
        content.innerHTML = `
          <h2 class="activity-title">Tes valeurs</h2>
          <div class="options-list">
            ${activityState.responses.values.map(value => `
              <div class="option-item selected">
                <div class="checkbox"></div>
                <span>${value}</span>
              </div>
            `).join('')}
          </div>
          <p style="font-size: 16px; font-weight: 700; margin: 24px 0;">
            Pourquoi ces valeurs sont importantes pour moi ?
          </p>
          <textarea class="text-input" rows="5" placeholder="Explique..." id="valuesReason"></textarea>
          <button class="button-primary" id="finishActivity">Terminer</button>
        `;
        
        content.querySelector('#finishActivity').addEventListener('click', async () => {
          activityState.responses.reason = document.getElementById('valuesReason').value;
          await saveActivity();
        });
      }
    }

    function renderMoiAutres() {
      const content = document.getElementById('activityContent');
      
      content.innerHTML = `
        <h2 class="activity-title">Moi / Les autres</h2>
        <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 32px;">
          Complete ces deux phrases
        </p>
        
        <div style="background: linear-gradient(135deg, #46D9D2 0%, #3bc5be 100%); border-radius: 20px; padding: 24px; margin-bottom: 24px;">
          <h3 style="font-size: 18px; font-weight: 800; color: white; margin: 0 0 16px 0;">
            Ce que je pense de moi :
          </h3>
          <textarea class="text-input" rows="4" placeholder="Je suis..." id="aboutMe" style="background: white;"></textarea>
        </div>
        
        <div style="background: linear-gradient(135deg, #FF4F73 0%, #e64565 100%); border-radius: 20px; padding: 24px;">
          <h3 style="font-size: 18px; font-weight: 800; color: white; margin: 0 0 16px 0;">
            Ce que les autres pensent de moi :
          </h3>
          <textarea class="text-input" rows="4" placeholder="Les autres disent que je suis..." id="othersThink" style="background: white;"></textarea>
        </div>
        
        <button class="button-primary" id="finishActivity">Terminer</button>
      `;
      
      content.querySelector('#finishActivity').addEventListener('click', async () => {
        activityState.responses.aboutMe = document.getElementById('aboutMe').value;
        activityState.responses.othersThink = document.getElementById('othersThink').value;
        await saveActivity();
      });
    }

    function renderMoodboard() {
      const content = document.getElementById('activityContent');
      
      const motivations = [
        { emoji: 'üí∞', label: 'Gagner de l\'argent' },
        { emoji: 'üë®‚Äçüë©‚Äçüëß', label: 'Aider ma famille' },
        { emoji: 'üéì', label: 'Apprendre' },
        { emoji: 'üåü', label: '√ätre reconnu' },
        { emoji: 'üöÄ', label: 'R√©ussir' },
        { emoji: 'üé®', label: 'Cr√©er' },
        { emoji: 'ü§ù', label: 'Aider les autres' },
        { emoji: 'üè†', label: 'Avoir mon chez-moi' },
        { emoji: '‚úàÔ∏è', label: 'Voyager' }
      ];
      
      activityState.selectedMotivations = activityState.selectedMotivations || [];
      
      content.innerHTML = `
        <h2 class="activity-title">Ce qui me motive</h2>
        <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 20px;">
          Choisis 3 motivations (${activityState.selectedMotivations.length}/3)
        </p>
        
        <div class="image-grid">
          ${motivations.map(item => `
            <div class="image-card ${activityState.selectedMotivations.includes(item.label) ? 'selected' : ''}" 
                 data-motivation="${item.label}">
              <div>
                <div style="font-size: 48px;">${item.emoji}</div>
                <div style="font-size: 12px; font-weight: 700; margin-top: 8px;">${item.label}</div>
              </div>
            </div>
          `).join('')}
        </div>
        
        <button class="button-primary" id="finishActivity" ${activityState.selectedMotivations.length !== 3 ? 'disabled' : ''}>
          Terminer
        </button>
      `;
      
      content.querySelectorAll('.image-card').forEach(card => {
        card.addEventListener('click', () => {
          const motivation = card.dataset.motivation;
          const selected = activityState.selectedMotivations || [];
          
          if (card.classList.contains('selected')) {
            card.classList.remove('selected');
            activityState.selectedMotivations = selected.filter(m => m !== motivation);
          } else if (selected.length < 3) {
            card.classList.add('selected');
            activityState.selectedMotivations = [...selected, motivation];
          }
          
          renderMoodboard();
        });
      });
      
      if (activityState.selectedMotivations.length === 3) {
        content.querySelector('#finishActivity').addEventListener('click', async () => {
          activityState.responses.motivations = activityState.selectedMotivations;
          await saveActivity();
        });
      }
    }

    function renderAction321() {
      const content = document.getElementById('activityContent');
      
      content.innerHTML = `
        <h2 class="activity-title">3-2-1 Action !</h2>
        
        <div style="background: linear-gradient(135deg, #FF4F73 0%, #e64565 100%); border-radius: 20px; padding: 24px; margin-bottom: 16px;">
          <h3 style="font-size: 18px; font-weight: 800; color: white; margin: 0 0 12px 0;">
            3Ô∏è‚É£ Trois choses que je veux faire
          </h3>
          <input type="text" class="text-input" placeholder="1..." id="action1" style="background: white; margin-bottom: 8px;">
          <input type="text" class="text-input" placeholder="2..." id="action2" style="background: white; margin-bottom: 8px;">
          <input type="text" class="text-input" placeholder="3..." id="action3" style="background: white;">
        </div>
        
        <div style="background: linear-gradient(135deg, #FFD75B 0%, #ffc940 100%); border-radius: 20px; padding: 24px; margin-bottom: 16px;">
          <h3 style="font-size: 18px; font-weight: 800; color: #1a1a1a; margin: 0 0 12px 0;">
            2Ô∏è‚É£ Deux obstacles possibles
          </h3>
          <input type="text" class="text-input" placeholder="Obstacle 1..." id="obstacle1" style="background: white; margin-bottom: 8px;">
          <input type="text" class="text-input" placeholder="Obstacle 2..." id="obstacle2" style="background: white;">
        </div>
        
        <div style="background: linear-gradient(135deg, #46D9D2 0%, #3bc5be 100%); border-radius: 20px; padding: 24px;">
          <h3 style="font-size: 18px; font-weight: 800; color: white; margin: 0 0 12px 0;">
            1Ô∏è‚É£ Une action cette semaine
          </h3>
          <input type="text" class="text-input" placeholder="Je vais..." id="oneAction" style="background: white;">
        </div>
        
        <button class="button-primary" id="finishActivity">Terminer</button>
      `;
      
      content.querySelector('#finishActivity').addEventListener('click', async () => {
        activityState.responses = {
          actions: [
            document.getElementById('action1').value,
            document.getElementById('action2').value,
            document.getElementById('action3').value
          ],
          obstacles: [
            document.getElementById('obstacle1').value,
            document.getElementById('obstacle2').value
          ],
          oneAction: document.getElementById('oneAction').value
        };
        await saveActivity();
      });
    }

    function renderAvantagesInconvenients() {
      const content = document.getElementById('activityContent');
      
      if (activityState.step === 1) {
        content.innerHTML = `
          <h2 class="activity-title">Avantages / Inconv√©nients</h2>
          <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 32px;">
            Quelle d√©cision tu dois prendre ?
          </p>
          <input type="text" class="text-input" placeholder="Exemple : Accepter ce stage, d√©m√©nager..." id="decision">
          <button class="button-primary" id="nextStep">Suivant</button>
        `;
        
        content.querySelector('#nextStep').addEventListener('click', () => {
          activityState.responses.decision = document.getElementById('decision').value;
          activityState.step = 2;
          renderAvantagesInconvenients();
        });
      } else if (activityState.step === 2) {
        content.innerHTML = `
          <h2 class="activity-title">${activityState.responses.decision}</h2>
          
          <div style="background: linear-gradient(135deg, #46D9D2 0%, #3bc5be 100%); border-radius: 20px; padding: 24px; margin-bottom: 24px;">
            <h3 style="font-size: 18px; font-weight: 800; color: white; margin: 0 0 16px 0;">
              ‚úÖ Les avantages
            </h3>
            <textarea class="text-input" rows="4" placeholder="Ce que je gagne si je le fais..." id="advantages" style="background: white;"></textarea>
          </div>
          
          <div style="background: linear-gradient(135deg, #FF4F73 0%, #e64565 100%); border-radius: 20px; padding: 24px;">
            <h3 style="font-size: 18px; font-weight: 800; color: white; margin: 0 0 16px 0;">
              ‚ùå Les inconv√©nients
            </h3>
            <textarea class="text-input" rows="4" placeholder="Ce que je perds ou les risques..." id="disadvantages" style="background: white;"></textarea>
          </div>
          
          <button class="button-primary" id="finishActivity">Terminer</button>
        `;
        
        content.querySelector('#finishActivity').addEventListener('click', async () => {
          activityState.responses.advantages = document.getElementById('advantages').value;
          activityState.responses.disadvantages = document.getElementById('disadvantages').value;
          await saveActivity();
        });
      }
    }

    function renderFeuTricolore() {
      const content = document.getElementById('activityContent');
      
      if (activityState.step === 1) {
        content.innerHTML = `
          <h2 class="activity-title">Le feu du choix</h2>
          <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 32px;">
            Quelle situation tu analyses ?
          </p>
          <input type="text" class="text-input" placeholder="D√©cris la situation..." id="situation">
          <button class="button-primary" id="nextStep">Suivant</button>
        `;
        
        content.querySelector('#nextStep').addEventListener('click', () => {
          activityState.responses.situation = document.getElementById('situation').value;
          activityState.step = 2;
          renderFeuTricolore();
        });
      } else if (activityState.step === 2) {
        content.innerHTML = `
          <h2 class="activity-title">Ton feu tricolore</h2>
          
          <div style="background: #FF3B5C; border-radius: 20px; padding: 24px; margin-bottom: 16px;">
            <h3 style="font-size: 18px; font-weight: 800; color: white; margin: 0 0 12px 0;">
              üî¥ Danger : ce qui pourrait mal tourner
            </h3>
            <textarea class="text-input" rows="3" id="red" style="background: white;"></textarea>
          </div>
          
          <div style="background: #FFD93D; border-radius: 20px; padding: 24px; margin-bottom: 16px;">
            <h3 style="font-size: 18px; font-weight: 800; color: #1a1a1a; margin: 0 0 12px 0;">
              üü° Attention : ce que je dois v√©rifier
            </h3>
            <textarea class="text-input" rows="3" id="yellow" style="background: white;"></textarea>
          </div>
          
          <div style="background: #00D4AA; border-radius: 20px; padding: 24px;">
            <h3 style="font-size: 18px; font-weight: 800; color: white; margin: 0 0 12px 0;">
              üü¢ Go : ce qui est bon pour moi
            </h3>
            <textarea class="text-input" rows="3" id="green" style="background: white;"></textarea>
          </div>
          
          <button class="button-primary" id="finishActivity">Terminer</button>
        `;
        
        content.querySelector('#finishActivity').addEventListener('click', async () => {
          activityState.responses.red = document.getElementById('red').value;
          activityState.responses.yellow = document.getElementById('yellow').value;
          activityState.responses.green = document.getElementById('green').value;
          await saveActivity();
        });
      }
    }

    function renderPauseRespiration() {
      const content = document.getElementById('activityContent');
      
      content.innerHTML = `
        <h2 class="activity-title">Pause 10 secondes</h2>
        <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 32px;">
          Prends 10 secondes pour respirer calmement
        </p>
        
        <div style="text-align: center; margin: 48px 0;">
          <div id="breatheCircle" style="width: 200px; height: 200px; margin: 0 auto; 
               background: linear-gradient(135deg, #46D9D2 0%, #3bc5be 100%); 
               border-radius: 50%; display: flex; align-items: center; justify-content: center; 
               font-size: 72px; transition: transform 4s ease-in-out;">
            ü´Å
          </div>
          <p id="breatheText" style="font-size: 24px; font-weight: 800; color: #46D9D2; margin-top: 24px;">
            Inspire...
          </p>
        </div>
        
        <button class="button-primary" id="startBreathing">Commencer</button>
        <button class="button-primary" id="finishActivity" style="display: none;">Terminer</button>
      `;
      
      let breathCount = 0;
      
      content.querySelector('#startBreathing').addEventListener('click', () => {
        content.querySelector('#startBreathing').style.display = 'none';
        
        const circle = document.getElementById('breatheCircle');
        const text = document.getElementById('breatheText');
        
        const breatheCycle = () => {
          circle.style.transform = 'scale(1.3)';
          text.textContent = 'Inspire...';
          text.style.color = '#46D9D2';
          
          setTimeout(() => {
            circle.style.transform = 'scale(1)';
            text.textContent = 'Expire...';
            text.style.color = '#FF4F73';
            
            breathCount++;
            if (breathCount < 3) {
              setTimeout(breatheCycle, 4000);
            } else {
              setTimeout(() => {
                text.textContent = '‚úÖ Bien jou√© !';
                text.style.color = '#00D4AA';
                content.querySelector('#finishActivity').style.display = 'block';
              }, 4000);
            }
          }, 4000);
        };
        
        breatheCycle();
      });
      
      content.querySelector('#finishActivity').addEventListener('click', async () => {
        activityState.responses.completed = true;
        await saveActivity();
      });
    }

    function renderAChaudAFroid() {
      const content = document.getElementById('activityContent');
      
      content.innerHTML = `
        <h2 class="activity-title">√Ä chaud / √Ä froid</h2>
        
        <div style="background: linear-gradient(135deg, #FF4F73 0%, #e64565 100%); border-radius: 20px; padding: 24px; margin-bottom: 24px;">
          <h3 style="font-size: 18px; font-weight: 800; color: white; margin: 0 0 16px 0;">
            üî• √Ä chaud (dans le moment)
          </h3>
          <p style="color: white; margin-bottom: 12px; font-size: 14px;">
            Quand je suis √©nerv√©, sur le moment je :
          </p>
          <textarea class="text-input" rows="4" placeholder="Ma r√©action imm√©diate..." id="hotReaction" style="background: white;"></textarea>
        </div>
        
        <div style="background: linear-gradient(135deg, #46D9D2 0%, #3bc5be 100%); border-radius: 20px; padding: 24px;">
          <h3 style="font-size: 18px; font-weight: 800; color: white; margin: 0 0 16px 0;">
            ‚ùÑÔ∏è √Ä froid (apr√®s r√©flexion)
          </h3>
          <p style="color: white; margin-bottom: 12px; font-size: 14px;">
            Plus tard, je me rends compte que :
          </p>
          <textarea class="text-input" rows="4" placeholder="Avec du recul..." id="coldReflection" style="background: white;"></textarea>
        </div>
        
        <button class="button-primary" id="finishActivity">Terminer</button>
      `;
      
      content.querySelector('#finishActivity').addEventListener('click', async () => {
        activityState.responses.hotReaction = document.getElementById('hotReaction').value;
        activityState.responses.coldReflection = document.getElementById('coldReflection').value;
        await saveActivity();
      });
    }

    // ===== AXE 2 - VALORISATION DE SOI =====

    function renderMiniReussites() {
      const content = document.getElementById('activityContent');
      
      content.innerHTML = `
        <h2 class="activity-title">Mes 3 mini-r√©ussites</h2>
        <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 32px;">
          Pense √† 3 petites choses que tu as r√©ussies r√©cemment
        </p>
        
        <div style="display: flex; flex-direction: column; gap: 16px; margin: 24px 0;">
          <div style="background: #FFD75B; border-radius: 16px; padding: 20px;">
            <h3 style="font-size: 16px; font-weight: 800; margin: 0 0 12px 0;">ü•â R√©ussite 1</h3>
            <input type="text" class="text-input" placeholder="Quelque chose que j'ai fait..." id="success1" style="background: white;">
          </div>
          
          <div style="background: #C0C0C0; border-radius: 16px; padding: 20px;">
            <h3 style="font-size: 16px; font-weight: 800; margin: 0 0 12px 0;">ü•à R√©ussite 2</h3>
            <input type="text" class="text-input" placeholder="Quelque chose que j'ai fait..." id="success2" style="background: white;">
          </div>
          
          <div style="background: #FFD700; border-radius: 16px; padding: 20px;">
            <h3 style="font-size: 16px; font-weight: 800; margin: 0 0 12px 0;">ü•á R√©ussite 3</h3>
            <input type="text" class="text-input" placeholder="Quelque chose que j'ai fait..." id="success3" style="background: white;">
          </div>
        </div>
        
        <button class="button-primary" id="finishActivity">Terminer</button>
      `;
      
      content.querySelector('#finishActivity').addEventListener('click', async () => {
        activityState.responses = {
          success1: document.getElementById('success1').value,
          success2: document.getElementById('success2').value,
          success3: document.getElementById('success3').value
        };
        await saveActivity();
      });
    }

    function renderJeProgresse() {
      const content = document.getElementById('activityContent');
      
      content.innerHTML = `
        <h2 class="activity-title">Je progresse quand...</h2>
        <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 32px;">
          Complete cette phrase
        </p>
        
        <div style="background: linear-gradient(135deg, #46D9D2 0%, #3bc5be 100%); border-radius: 20px; padding: 32px; margin: 24px 0;">
          <p style="font-size: 20px; font-weight: 800; color: white; text-align: center; margin: 0 0 24px 0;">
            Je progresse quand...
          </p>
          <textarea class="text-input" rows="6" placeholder="D√©cris ce qui t'aide √† progresser..." id="progress" style="background: white;"></textarea>
        </div>
        
        <button class="button-primary" id="finishActivity">Terminer</button>
      `;
      
      content.querySelector('#finishActivity').addEventListener('click', async () => {
        activityState.responses.progress = document.getElementById('progress').value;
        await saveActivity();
      });
    }

    function renderDireEnImages() {
      const content = document.getElementById('activityContent');
      
      const imageOptions = [
        { emoji: 'üí™', label: 'Force' },
        { emoji: 'üß†', label: 'Intelligence' },
        { emoji: '‚ù§Ô∏è', label: 'Coeur' },
        { emoji: 'üòä', label: 'Joie' },
        { emoji: 'üéØ', label: 'D√©termination' },
        { emoji: 'ü§ù', label: 'Solidarit√©' },
        { emoji: 'üåü', label: 'Talent' },
        { emoji: 'üé®', label: 'Cr√©ativit√©' },
        { emoji: 'üî•', label: 'Passion' }
      ];
      
      activityState.selectedImages = activityState.selectedImages || [];
      
      content.innerHTML = `
        <h2 class="activity-title">Dire ce que je veux en 3 images</h2>
        <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 20px;">
          Choisis 3 images qui te repr√©sentent (${activityState.selectedImages.length}/3)
        </p>
        
        <div class="image-grid">
          ${imageOptions.map(item => `
            <div class="image-card ${activityState.selectedImages.includes(item.label) ? 'selected' : ''}" 
                 data-image="${item.label}">
              <div>
                <div style="font-size: 48px;">${item.emoji}</div>
                <div style="font-size: 12px; font-weight: 700; margin-top: 8px;">${item.label}</div>
              </div>
            </div>
          `).join('')}
        </div>
        
        <button class="button-primary" id="finishActivity" ${activityState.selectedImages.length !== 3 ? 'disabled' : ''}>
          Terminer
        </button>
      `;
      
      content.querySelectorAll('.image-card').forEach(card => {
        card.addEventListener('click', () => {
          const image = card.dataset.image;
          const selected = activityState.selectedImages || [];
          
          if (card.classList.contains('selected')) {
            card.classList.remove('selected');
            activityState.selectedImages = selected.filter(i => i !== image);
          } else if (selected.length < 3) {
            card.classList.add('selected');
            activityState.selectedImages = [...selected, image];
          }
          
          renderDireEnImages();
        });
      });
      
      if (activityState.selectedImages.length === 3) {
        content.querySelector('#finishActivity').addEventListener('click', async () => {
          activityState.responses.images = activityState.selectedImages;
          await saveActivity();
        });
      }
    }

    function renderAmiConseillerEmployeur() {
      const content = document.getElementById('activityContent');
      
      content.innerHTML = `
        <h2 class="activity-title">Ami / Conseiller / Employeur</h2>
        <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 32px;">
          Comment tu te pr√©sentes selon la personne ?
        </p>
        
        <div style="background: linear-gradient(135deg, #FFD75B 0%, #ffc940 100%); border-radius: 20px; padding: 24px; margin-bottom: 16px;">
          <h3 style="font-size: 18px; font-weight: 800; color: #1a1a1a; margin: 0 0 12px 0;">
            üëã √Ä un ami
          </h3>
          <textarea class="text-input" rows="3" placeholder="Salut ! Moi c'est..." id="toFriend" style="background: white;"></textarea>
        </div>
        
        <div style="background: linear-gradient(135deg, #46D9D2 0%, #3bc5be 100%); border-radius: 20px; padding: 24px; margin-bottom: 16px;">
          <h3 style="font-size: 18px; font-weight: 800; color: white; margin: 0 0 12px 0;">
            ü§ù √Ä un conseiller ML
          </h3>
          <textarea class="text-input" rows="3" placeholder="Bonjour, je m'appelle..." id="toAdvisor" style="background: white;"></textarea>
        </div>
        
        <div style="background: linear-gradient(135deg, #FF4F73 0%, #e64565 100%); border-radius: 20px; padding: 24px;">
          <h3 style="font-size: 18px; font-weight: 800; color: white; margin: 0 0 12px 0;">
            üíº √Ä un employeur
          </h3>
          <textarea class="text-input" rows="3" placeholder="Bonjour, je suis..." id="toEmployer" style="background: white;"></textarea>
        </div>
        
        <button class="button-primary" id="finishActivity">Terminer</button>
      `;
      
      content.querySelector('#finishActivity').addEventListener('click', async () => {
        activityState.responses = {
          toFriend: document.getElementById('toFriend').value,
          toAdvisor: document.getElementById('toAdvisor').value,
          toEmployer: document.getElementById('toEmployer').value
        };
        await saveActivity();
      });
    }

    function renderVieCompetences() {
      const content = document.getElementById('activityContent');
      
      content.innerHTML = `
        <h2 class="activity-title">Ma vie = comp√©tences</h2>
        <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 32px;">
          Transforme tes exp√©riences en comp√©tences
        </p>
        
        <div style="display: flex; flex-direction: column; gap: 20px; margin: 24px 0;">
          <div style="background: #f8f9fa; border-radius: 16px; padding: 20px; border: 3px solid #46D9D2;">
            <h3 style="font-size: 16px; font-weight: 800; margin: 0 0 12px 0; color: #46D9D2;">
              Ce que j'ai fait
            </h3>
            <input type="text" class="text-input" placeholder="Exemple : J'ai gard√© mes fr√®res et soeurs" id="experience">
          </div>
          
          <div style="text-align: center; font-size: 32px;">‚¨áÔ∏è</div>
          
          <div style="background: #f8f9fa; border-radius: 16px; padding: 20px; border: 3px solid #FFD75B;">
            <h3 style="font-size: 16px; font-weight: 800; margin: 0 0 12px 0; color: #FF8C00;">
              La comp√©tence que √ßa montre
            </h3>
            <input type="text" class="text-input" placeholder="Exemple : Je sais m'occuper d'enfants, √™tre responsable" id="skill">
          </div>
        </div>
        
        <button class="button-primary" id="finishActivity">Terminer</button>
      `;
      
      content.querySelector('#finishActivity').addEventListener('click', async () => {
        activityState.responses = {
          experience: document.getElementById('experience').value,
          skill: document.getElementById('skill').value
        };
        await saveActivity();
      });
    }

    function renderPitch20s() {
      const content = document.getElementById('activityContent');
      
      content.innerHTML = `
        <h2 class="activity-title">Mon pitch 20 secondes</h2>
        <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 32px;">
          Pr√©sente-toi en quelques phrases courtes
        </p>
        
        <div style="background: linear-gradient(135deg, #FF4F73 0%, #e64565 100%); border-radius: 20px; padding: 24px; margin-bottom: 24px;">
          <h3 style="font-size: 16px; font-weight: 800; color: white; margin: 0 0 12px 0;">
            Qui je suis
          </h3>
          <input type="text" class="text-input" placeholder="Mon nom, mon √¢ge..." id="whoIAm" style="background: white;">
        </div>
        
        <div style="background: linear-gradient(135deg, #46D9D2 0%, #3bc5be 100%); border-radius: 20px; padding: 24px; margin-bottom: 24px;">
          <h3 style="font-size: 16px; font-weight: 800; color: white; margin: 0 0 12px 0;">
            Ce que je cherche
          </h3>
          <input type="text" class="text-input" placeholder="Formation, stage, emploi..." id="whatIWant" style="background: white;">
        </div>
        
        <div style="background: linear-gradient(135deg, #FFD75B 0%, #ffc940 100%); border-radius: 20px; padding: 24px;">
          <h3 style="font-size: 16px; font-weight: 800; color: #1a1a1a; margin: 0 0 12px 0;">
            Mes atouts
          </h3>
          <input type="text" class="text-input" placeholder="Ce que je sais faire..." id="myAssets" style="background: white;">
        </div>
        
        <button class="button-primary" id="finishActivity">Terminer</button>
      `;
      
      content.querySelector('#finishActivity').addEventListener('click', async () => {
        activityState.responses = {
          whoIAm: document.getElementById('whoIAm').value,
          whatIWant: document.getElementById('whatIWant').value,
          myAssets: document.getElementById('myAssets').value
        };
        await saveActivity();
      });
    }

    function renderSignauxSociaux() {
      const content = document.getElementById('activityContent');
      
      const situations = [
        { emoji: 'üòä', signal: 'Sourire', meaning: 'La personne est ouverte / contente' },
        { emoji: 'üò§', signal: 'Sourcils fronc√©s', meaning: 'La personne est agac√©e / pas d\'accord' },
        { emoji: 'üôÑ', signal: 'Regard ailleurs', meaning: 'La personne s\'ennuie ou n\'√©coute pas' },
        { emoji: 'üëç', signal: 'Hochement de t√™te', meaning: 'La personne est d\'accord / encourage' }
      ];
      
      content.innerHTML = `
        <h2 class="activity-title">Je rep√®re les signaux sociaux</h2>
        <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 32px;">
          Associe chaque signal √† sa signification
        </p>
        
        ${situations.map((situation, idx) => `
          <div style="background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%); 
                      border: 3px solid #46D9D2; border-radius: 20px; padding: 20px; margin-bottom: 16px;">
            <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 12px;">
              <div style="font-size: 48px;">${situation.emoji}</div>
              <div>
                <h3 style="font-size: 18px; font-weight: 800; margin: 0;">${situation.signal}</h3>
                <p style="font-size: 14px; color: #6c757d; margin: 4px 0 0 0;">${situation.meaning}</p>
              </div>
            </div>
          </div>
        `).join('')}
        
        <p style="font-size: 16px; font-weight: 700; margin: 24px 0;">
          Un signal que je dois mieux rep√©rer :
        </p>
        <input type="text" class="text-input" placeholder="Quel signal tu veux mieux comprendre..." id="signalToWork">
        
        <button class="button-primary" id="finishActivity">Terminer</button>
      `;
      
      content.querySelector('#finishActivity').addEventListener('click', async () => {
        activityState.responses.signalToWork = document.getElementById('signalToWork').value;
        await saveActivity();
      });
    }

    function renderGererDesaccord() {
      const content = document.getElementById('activityContent');
      
      content.innerHTML = `
        <h2 class="activity-title">G√©rer un d√©saccord simple</h2>
        
        <div style="background: linear-gradient(135deg, #FF4F73 0%, #e64565 100%); border-radius: 20px; padding: 24px; margin-bottom: 16px;">
          <h3 style="font-size: 16px; font-weight: 800; color: white; margin: 0 0 12px 0;">
            ‚ùå √Ä √©viter
          </h3>
          <ul style="color: white; margin: 0; padding-left: 20px;">
            <li>Crier ou insulter</li>
            <li>Partir sans rien dire</li>
            <li>Faire comme si de rien n'√©tait</li>
          </ul>
        </div>
        
        <div style="background: linear-gradient(135deg, #46D9D2 0%, #3bc5be 100%); border-radius: 20px; padding: 24px; margin-bottom: 24px;">
          <h3 style="font-size: 16px; font-weight: 800; color: white; margin: 0 0 12px 0;">
            ‚úÖ √Ä faire
          </h3>
          <ul style="color: white; margin: 0; padding-left: 20px;">
            <li>Dire calmement ce qui me g√™ne</li>
            <li>√âcouter l'autre aussi</li>
            <li>Chercher une solution ensemble</li>
          </ul>
        </div>
        
        <p style="font-size: 16px; font-weight: 700; margin: 24px 0;">
          Un d√©saccord r√©cent que j'ai eu :
        </p>
        <textarea class="text-input" rows="3" placeholder="D√©cris la situation..." id="disagreement"></textarea>
        
        <p style="font-size: 16px; font-weight: 700; margin: 24px 0;">
          Comment je pourrais mieux le g√©rer :
        </p>
        <textarea class="text-input" rows="4" placeholder="Avec du recul..." id="betterWay"></textarea>
        
        <button class="button-primary" id="finishActivity">Terminer</button>
      `;
      
      content.querySelector('#finishActivity').addEventListener('click', async () => {
        activityState.responses = {
          disagreement: document.getElementById('disagreement').value,
          betterWay: document.getElementById('betterWay').value
        };
        await saveActivity();
      });
    }

    function renderDireOuiNon() {
      const content = document.getElementById('activityContent');
      
      content.innerHTML = `
        <h2 class="activity-title">Dire OUI / dire NON</h2>
        
        <div style="background: linear-gradient(135deg, #46D9D2 0%, #3bc5be 100%); border-radius: 20px; padding: 24px; margin-bottom: 24px;">
          <h3 style="font-size: 18px; font-weight: 800; color: white; margin: 0 0 16px 0;">
            ‚úÖ Je dis OUI quand...
          </h3>
          <textarea class="text-input" rows="4" placeholder="Dans quelles situations tu acceptes..." id="sayYes" style="background: white;"></textarea>
        </div>
        
        <div style="background: linear-gradient(135deg, #FF4F73 0%, #e64565 100%); border-radius: 20px; padding: 24px;">
          <h3 style="font-size: 18px; font-weight: 800; color: white; margin: 0 0 16px 0;">
            ‚ùå Je dis NON quand...
          </h3>
          <textarea class="text-input" rows="4" placeholder="Dans quelles situations tu refuses..." id="sayNo" style="background: white;"></textarea>
        </div>
        
        <button class="button-primary" id="finishActivity">Terminer</button>
      `;
      
      content.querySelector('#finishActivity').addEventListener('click', async () => {
        activityState.responses = {
          sayYes: document.getElementById('sayYes').value,
          sayNo: document.getElementById('sayNo').value
        };
        await saveActivity();
      });
    }

    function renderMesLimites() {
      const content = document.getElementById('activityContent');
      
      content.innerHTML = `
        <h2 class="activity-title">Mes limites en 3 phrases</h2>
        <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 32px;">
          Exprime tes limites clairement
        </p>
        
        <div style="display: flex; flex-direction: column; gap: 20px; margin: 24px 0;">
          <div style="background: #f8f9fa; border-radius: 16px; padding: 20px; border: 3px solid #FF4F73;">
            <h3 style="font-size: 16px; font-weight: 800; margin: 0 0 12px 0; color: #FF4F73;">
              1Ô∏è‚É£ Ce que je n'accepte pas
            </h3>
            <input type="text" class="text-input" placeholder="Exemple : Qu'on me manque de respect" id="limit1">
          </div>
          
          <div style="background: #f8f9fa; border-radius: 16px; padding: 20px; border: 3px solid #FFD75B;">
            <h3 style="font-size: 16px; font-weight: 800; margin: 0 0 12px 0; color: #FF8C00;">
              2Ô∏è‚É£ Ce qui me met mal √† l'aise
            </h3>
            <input type="text" class="text-input" placeholder="Exemple : Qu'on fouille dans mes affaires" id="limit2">
          </div>
          
          <div style="background: #f8f9fa; border-radius: 16px; padding: 20px; border: 3px solid #46D9D2;">
            <h3 style="font-size: 16px; font-weight: 800; margin: 0 0 12px 0; color: #46D9D2;">
              3Ô∏è‚É£ Ce dont j'ai besoin pour me sentir bien
            </h3>
            <input type="text" class="text-input" placeholder="Exemple : Avoir mon espace personnel" id="limit3">
          </div>
        </div>
        
        <button class="button-primary" id="finishActivity">Terminer</button>
      `;
      
      content.querySelector('#finishActivity').addEventListener('click', async () => {
        activityState.responses = {
          limit1: document.getElementById('limit1').value,
          limit2: document.getElementById('limit2').value,
          limit3: document.getElementById('limit3').value
        };
        await saveActivity();
      });
    }

    // ===== AXE 3 - BIEN-√äTRE =====

    function renderBatterieJour() {
      const content = document.getElementById('activityContent');
      
      content.innerHTML = `
        <h2 class="activity-title">Ma batterie du jour</h2>
        <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 32px;">
          √Ä combien est ta batterie aujourd'hui ?
        </p>
        
        <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 12px; margin: 24px 0;">
          ${[1, 2, 3, 4, 5].map(level => `
            <div class="battery-level" data-level="${level}" 
                 style="aspect-ratio: 1; background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); 
                 border: 3px solid #e9ecef; border-radius: 16px; display: flex; flex-direction: column; 
                 align-items: center; justify-content: center; cursor: pointer; transition: all 0.3s ease;">
              <div style="font-size: 32px; margin-bottom: 8px;">üîã</div>
              <div style="font-size: 20px; font-weight: 800;">${level * 20}%</div>
            </div>
          `).join('')}
        </div>
        
        <p style="font-size: 16px; font-weight: 700; margin: 24px 0;">
          Pourquoi je suis √† ce niveau ?
        </p>
        <textarea class="text-input" rows="4" placeholder="Explique..." id="batteryReason"></textarea>
        
        <button class="button-primary" id="finishActivity">Terminer</button>
      `;
      
      let selectedLevel = 0;
      
      content.querySelectorAll('.battery-level').forEach(card => {
        card.addEventListener('click', () => {
          content.querySelectorAll('.battery-level').forEach(c => {
            c.style.background = 'linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%)';
            c.style.borderColor = '#e9ecef';
          });
          
          selectedLevel = parseInt(card.dataset.level);
          card.style.background = 'linear-gradient(135deg, #46D9D2 0%, #3bc5be 100%)';
          card.style.borderColor = '#46D9D2';
        });
      });
      
      content.querySelector('#finishActivity').addEventListener('click', async () => {
        activityState.responses = {
          level: selectedLevel,
          reason: document.getElementById('batteryReason').value
        };
        await saveActivity();
      });
    }

    function renderEpuiseRecharge() {
      const content = document.getElementById('activityContent');
      
      content.innerHTML = `
        <h2 class="activity-title">√áa m'ÔøΩÔøΩpuise / √ßa me recharge</h2>
        
        <div style="background: linear-gradient(135deg, #FF4F73 0%, #e64565 100%); border-radius: 20px; padding: 24px; margin-bottom: 24px;">
          <h3 style="font-size: 18px; font-weight: 800; color: white; margin: 0 0 16px 0;">
            üî¥ Ce qui m'√©puise
          </h3>
          <textarea class="text-input" rows="4" placeholder="Les situations, personnes, activit√©s qui te fatiguent..." id="drains" style="background: white;"></textarea>
        </div>
        
        <div style="background: linear-gradient(135deg, #46D9D2 0%, #3bc5be 100%); border-radius: 20px; padding: 24px;">
          <h3 style="font-size: 18px; font-weight: 800; color: white; margin: 0 0 16px 0;">
            üü¢ Ce qui me recharge
          </h3>
          <textarea class="text-input" rows="4" placeholder="Les situations, personnes, activit√©s qui te ressourcent..." id="recharges" style="background: white;"></textarea>
        </div>
        
        <button class="button-primary" id="finishActivity">Terminer</button>
      `;
      
      content.querySelector('#finishActivity').addEventListener('click', async () => {
        activityState.responses = {
          drains: document.getElementById('drains').value,
          recharges: document.getElementById('recharges').value
        };
        await saveActivity();
      });
    }

    function renderStressMoment() {
      const content = document.getElementById('activityContent');
      
      content.innerHTML = `
        <h2 class="activity-title">Mon stress du moment</h2>
        <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 32px;">
          √âvalue ton niveau de stress sur une √©chelle de 1 √† 10
        </p>
        
        <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; margin: 24px 0;">
          ${[1, 2, 3, 4, 5, 6, 7, 8, 9, 10].map(level => `
            <div class="stress-level" data-level="${level}" 
                 style="aspect-ratio: 1; background: ${level <= 3 ? '#46D9D2' : level <= 6 ? '#FFD75B' : '#FF4F73'}; 
                 border: 3px solid transparent; border-radius: 12px; display: flex; align-items: center; 
                 justify-content: center; cursor: pointer; transition: all 0.3s ease; opacity: 0.3;">
              <span style="font-size: 20px; font-weight: 800; color: white;">${level}</span>
            </div>
          `).join('')}
        </div>
        
        <p style="font-size: 16px; font-weight: 700; margin: 24px 0;">
          Qu'est-ce qui me stresse en ce moment ?
        </p>
        <textarea class="text-input" rows="5" placeholder="Explique..." id="stressReason"></textarea>
        
        <button class="button-primary" id="finishActivity">Terminer</button>
      `;
      
      let selectedLevel = 0;
      
      content.querySelectorAll('.stress-level').forEach(card => {
        card.addEventListener('click', () => {
          content.querySelectorAll('.stress-level').forEach(c => c.style.opacity = '0.3');
          selectedLevel = parseInt(card.dataset.level);
          card.style.opacity = '1';
          card.style.transform = 'scale(1.1)';
        });
      });
      
      content.querySelector('#finishActivity').addEventListener('click', async () => {
        activityState.responses = {
          level: selectedLevel,
          reason: document.getElementById('stressReason').value
        };
        await saveActivity();
      });
    }

    function renderPause30s() {
      const content = document.getElementById('activityContent');
      
      content.innerHTML = `
        <h2 class="activity-title">Ma pause 30 secondes</h2>
        <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 32px;">
          Prends 30 secondes pour te recentrer
        </p>
        
        <div style="text-align: center; margin: 48px 0;">
          <div id="timer" style="font-size: 72px; font-weight: 800; color: #46D9D2; margin-bottom: 24px;">
            30
          </div>
          <p id="timerText" style="font-size: 18px; color: #6c757d;">
            Ferme les yeux et respire calmement
          </p>
        </div>
        
        <button class="button-primary" id="startTimer">Commencer</button>
        <button class="button-primary" id="finishActivity" style="display: none;">Terminer</button>
      `;
      
      content.querySelector('#startTimer').addEventListener('click', () => {
        content.querySelector('#startTimer').style.display = 'none';
        let count = 30;
        
        const timerInterval = setInterval(() => {
          count--;
          document.getElementById('timer').textContent = count;
          
          if (count === 0) {
            clearInterval(timerInterval);
            document.getElementById('timer').textContent = '‚úÖ';
            document.getElementById('timerText').textContent = 'Bravo ! Tu as pris du temps pour toi';
            document.getElementById('timerText').style.color = '#00D4AA';
            content.querySelector('#finishActivity').style.display = 'block';
          }
        }, 1000);
      });
      
      content.querySelector('#finishActivity').addEventListener('click', async () => {
        activityState.responses.completed = true;
        await saveActivity();
      });
    }

    function renderDejaSurmonte() {
      const content = document.getElementById('activityContent');
      
      content.innerHTML = `
        <h2 class="activity-title">Ce que j'ai d√©j√† surmont√©</h2>
        <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 32px;">
          Pense √† une difficult√© que tu as surmont√©e
        </p>
        
        <div style="background: linear-gradient(135deg, #FF4F73 0%, #e64565 100%); border-radius: 20px; padding: 24px; margin-bottom: 24px;">
          <h3 style="font-size: 16px; font-weight: 800; color: white; margin: 0 0 12px 0;">
            La difficult√©
          </h3>
          <textarea class="text-input" rows="3" placeholder="Quelle √©tait la situation difficile..." id="difficulty" style="background: white;"></textarea>
        </div>
        
        <div style="background: linear-gradient(135deg, #46D9D2 0%, #3bc5be 100%); border-radius: 20px; padding: 24px;">
          <h3 style="font-size: 16px; font-weight: 800; color: white; margin: 0 0 12px 0;">
            Comment j'ai fait
          </h3>
          <textarea class="text-input" rows="4" placeholder="Comment tu t'en es sorti..." id="howOvercome" style="background: white;"></textarea>
        </div>
        
        <button class="button-primary" id="finishActivity">Terminer</button>
      `;
      
      content.querySelector('#finishActivity').addEventListener('click', async () => {
        activityState.responses = {
          difficulty: document.getElementById('difficulty').value,
          howOvercome: document.getElementById('howOvercome').value
        };
        await saveActivity();
      });
    }

    function renderPlanMicroReprise() {
      const content = document.getElementById('activityContent');
      
      content.innerHTML = `
        <h2 class="activity-title">Plan micro-reprise</h2>
        <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 32px;">
          Si tu as un coup dur, voici ton plan en 3 √©tapes
        </p>
        
        <div style="background: linear-gradient(135deg, #FFD75B 0%, #ffc940 100%); border-radius: 20px; padding: 24px; margin-bottom: 16px;">
          <h3 style="font-size: 16px; font-weight: 800; color: #1a1a1a; margin: 0 0 12px 0;">
            1Ô∏è‚É£ √âtape 1 : M'arr√™ter et respirer
          </h3>
          <input type="text" class="text-input" placeholder="Que fais-tu pour te calmer..." id="step1" style="background: white;">
        </div>
        
        <div style="background: linear-gradient(135deg, #46D9D2 0%, #3bc5be 100%); border-radius: 20px; padding: 24px; margin-bottom: 16px;">
          <h3 style="font-size: 16px; font-weight: 800; color: white; margin: 0 0 12px 0;">
            2Ô∏è‚É£ √âtape 2 : Appeler quelqu'un
          </h3>
          <input type="text" class="text-input" placeholder="Qui tu appelles..." id="step2" style="background: white;">
        </div>
        
        <div style="background: linear-gradient(135deg, #FF4F73 0%, #e64565 100%); border-radius: 20px; padding: 24px;">
          <h3 style="font-size: 16px; font-weight: 800; color: white; margin: 0 0 12px 0;">
            3Ô∏è‚É£ √âtape 3 : Faire une micro-action
          </h3>
          <input type="text" class="text-input" placeholder="Une toute petite chose que tu peux faire..." id="step3" style="background: white;">
        </div>
        
        <button class="button-primary" id="finishActivity">Terminer</button>
      `;
      
      content.querySelector('#finishActivity').addEventListener('click', async () => {
        activityState.responses = {
          step1: document.getElementById('step1').value,
          step2: document.getElementById('step2').value,
          step3: document.getElementById('step3').value
        };
        await saveActivity();
      });
    }

    function renderLieuSecurite() {
      const content = document.getElementById('activityContent');
      
      content.innerHTML = `
        <h2 class="activity-title">Mon lieu / moment s√©curit√©</h2>
        
        <div style="background: linear-gradient(135deg, #46D9D2 0%, #3bc5be 100%); border-radius: 20px; padding: 24px; margin-bottom: 24px;">
          <h3 style="font-size: 18px; font-weight: 800; color: white; margin: 0 0 16px 0;">
            üìç Mon lieu o√π je me sens en s√©curit√©
          </h3>
          <input type="text" class="text-input" placeholder="Chez moi, chez un ami, √† la ML..." id="securePlace" style="background: white;">
        </div>
        
        <div style="background: linear-gradient(135deg, #FFD75B 0%, #ffc940 100%); border-radius: 20px; padding: 24px;">
          <h3 style="font-size: 18px; font-weight: 800; color: #1a1a1a; margin: 0 0 16px 0;">
            ‚è∞ Mon moment o√π je me sens bien
          </h3>
          <input type="text" class="text-input" placeholder="Le matin, le soir, le week-end..." id="secureTime" style="background: white;">
        </div>
        
        <button class="button-primary" id="finishActivity">Terminer</button>
      `;
      
      content.querySelector('#finishActivity').addEventListener('click', async () => {
        activityState.responses = {
          securePlace: document.getElementById('securePlace').value,
          secureTime: document.getElementById('secureTime').value
        };
        await saveActivity();
      });
    }

    function renderQuiParler() {
      const content = document.getElementById('activityContent');
      
      const contacts = [
        { emoji: 'üë®‚Äçüë©‚Äçüëß', label: 'Famille' },
        { emoji: 'üë•', label: 'Ami(e)' },
        { emoji: 'üè¢', label: 'Conseiller ML' },
        { emoji: 'üë®‚Äç‚öïÔ∏è', label: 'Professionnel sant√©' },
        { emoji: 'üìû', label: 'Num√©ro d\'urgence' }
      ];
      
      activityState.selectedContacts = activityState.selectedContacts || [];
      
      content.innerHTML = `
        <h2 class="activity-title">√Ä qui je peux parler ?</h2>
        <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 32px;">
          Choisis au moins 2 personnes √† qui tu peux parler
        </p>
        
        <div class="options-list">
          ${contacts.map(contact => `
            <div class="option-item ${activityState.selectedContacts.includes(contact.label) ? 'selected' : ''}" 
                 data-contact="${contact.label}">
              <div class="checkbox"></div>
              <span style="font-size: 24px; margin-right: 12px;">${contact.emoji}</span>
              <span>${contact.label}</span>
            </div>
          `).join('')}
        </div>
        
        <p style="font-size: 16px; font-weight: 700; margin: 24px 0;">
          En cas de coup dur, je contacte en premier :
        </p>
        <input type="text" class="text-input" placeholder="Qui tu appelles en premier..." id="firstContact">
        
        <button class="button-primary" id="finishActivity">Terminer</button>
      `;
      
      content.querySelectorAll('.option-item').forEach(item => {
        item.addEventListener('click', () => {
          const contact = item.dataset.contact;
          const selected = activityState.selectedContacts || [];
          
          if (item.classList.contains('selected')) {
            item.classList.remove('selected');
            activityState.selectedContacts = selected.filter(c => c !== contact);
          } else {
            item.classList.add('selected');
            activityState.selectedContacts = [...selected, contact];
          }
        });
      });
      
      content.querySelector('#finishActivity').addEventListener('click', async () => {
        activityState.responses = {
          contacts: activityState.selectedContacts,
          firstContact: document.getElementById('firstContact').value
        };
        await saveActivity();
      });
    }

    function renderSignalAlerte() {
      const content = document.getElementById('activityContent');
      
      const signals = [
        'üò¥ Je dors mal',
        'üò§ Je suis tout le temps √©nerv√©',
        'üòî Je n\'ai envie de rien',
        'üçî Je mange trop ou pas assez',
        'üìµ Je m\'isole',
        'üí≠ Je rumine mes probl√®mes'
      ];
      
      activityState.selectedSignals = activityState.selectedSignals || [];
      
      content.innerHTML = `
        <h2 class="activity-title">Mon signal d'alerte</h2>
        <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 32px;">
          Quels signaux indiquent que tu ne vas pas bien ?
        </p>
        
        <div class="options-list">
          ${signals.map(signal => `
            <div class="option-item ${activityState.selectedSignals.includes(signal) ? 'selected' : ''}" 
                 data-signal="${signal}">
              <div class="checkbox"></div>
              <span>${signal}</span>
            </div>
          `).join('')}
        </div>
        
        <p style="font-size: 16px; font-weight: 700; margin: 24px 0;">
          Quand je rep√®re ce signal, je :
        </p>
        <textarea class="text-input" rows="4" placeholder="Que fais-tu quand tu remarques ces signaux..." id="action"></textarea>
        
        <button class="button-primary" id="finishActivity">Terminer</button>
      `;
      
      content.querySelectorAll('.option-item').forEach(item => {
        item.addEventListener('click', () => {
          const signal = item.dataset.signal;
          const selected = activityState.selectedSignals || [];
          
          if (item.classList.contains('selected')) {
            item.classList.remove('selected');
            activityState.selectedSignals = selected.filter(s => s !== signal);
          } else {
            item.classList.add('selected');
            activityState.selectedSignals = [...selected, signal];
          }
        });
      });
      
      content.querySelector('#finishActivity').addEventListener('click', async () => {
        activityState.responses = {
          signals: activityState.selectedSignals,
          action: document.getElementById('action').value
        };
        await saveActivity();
      });
    }

    function renderRessourcesBienEtre() {
      const content = document.getElementById('activityContent');
      
      const resources = [
        { emoji: 'üò¥', label: 'Bien dormir' },
        { emoji: 'üèÉ', label: 'Bouger / sport' },
        { emoji: 'üë•', label: 'Voir des gens' },
        { emoji: 'üéÆ', label: 'Activit√© plaisir' },
        { emoji: 'üßò', label: 'Moment calme' },
        { emoji: 'üçé', label: 'Bien manger' },
        { emoji: 'üí¨', label: 'Parler' },
        { emoji: 'üå≥', label: 'Sortir dehors' },
        { emoji: 'üéµ', label: 'Musique' }
      ];
      
      activityState.selectedResources = activityState.selectedResources || [];
      
      content.innerHTML = `
        <h2 class="activity-title">Mes 3 ressources bien-√™tre</h2>
        <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 20px;">
          Choisis 3 ressources (${activityState.selectedResources.length}/3)
        </p>
        
        <div class="image-grid">
          ${resources.map(resource => `
            <div class="image-card ${activityState.selectedResources.includes(resource.label) ? 'selected' : ''}" 
                 data-resource="${resource.label}">
              <div>
                <div style="font-size: 48px;">${resource.emoji}</div>
                <div style="font-size: 12px; font-weight: 700; margin-top: 8px;">${resource.label}</div>
              </div>
            </div>
          `).join('')}
        </div>
        
        <button class="button-primary" id="finishActivity" ${activityState.selectedResources.length !== 3 ? 'disabled' : ''}>
          Terminer
        </button>
      `;
      
      content.querySelectorAll('.image-card').forEach(card => {
        card.addEventListener('click', () => {
          const resource = card.dataset.resource;
          const selected = activityState.selectedResources || [];
          
          if (card.classList.contains('selected')) {
            card.classList.remove('selected');
            activityState.selectedResources = selected.filter(r => r !== resource);
          } else if (selected.length < 3) {
            card.classList.add('selected');
            activityState.selectedResources = [...selected, resource];
          }
          
          renderRessourcesBienEtre();
        });
      });
      
      if (activityState.selectedResources.length === 3) {
        content.querySelector('#finishActivity').addEventListener('click', async () => {
          activityState.responses.resources = activityState.selectedResources;
          await saveActivity();
        });
      }
    }

    // ===== NEW AXE 4 - RESSOURCES ACTIVITIES =====

    function renderPrioritesMois() {
      const content = document.getElementById('activityContent');
      
      if (activityState.step === 1) {
        const priorities = [
          { emoji: 'üè†', label: 'Logement' },
          { emoji: 'üöå', label: 'Transport' },
          { emoji: 'üõí', label: 'Courses' },
          { emoji: 'üì±', label: 'T√©l√©phone' },
          { emoji: 'üéÆ', label: 'Loisirs' },
          { emoji: 'üí≥', label: 'Dettes' },
          { emoji: 'üëï', label: 'V√™tements' },
          { emoji: 'üß¥', label: 'Hygi√®ne' },
          { emoji: 'üÜò', label: 'Impr√©vu' }
        ];
        
        const selectedPriorities = activityState.selectedPriorities || [];
        
        content.innerHTML = `
          <h2 class="activity-title">Mes 3 priorit√©s du mois</h2>
          <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 20px;">
            Choisis 3 prioritÔøΩÔøΩs pour ce mois (${selectedPriorities.length}/3)
          </p>
          
          <div class="image-grid">
            ${priorities.map(priority => `
              <div class="image-card ${selectedPriorities.includes(priority.label) ? 'selected' : ''}" 
                   data-priority="${priority.label}">
                <div>
                  <div style="font-size: 48px;">${priority.emoji}</div>
                  <div style="font-size: 12px; font-weight: 700; margin-top: 8px;">${priority.label}</div>
                </div>
              </div>
            `).join('')}
          </div>
          
          <button class="button-primary" id="nextStep" ${selectedPriorities.length !== 3 ? 'disabled' : ''}>
            Suivant
          </button>
        `;
        
        content.querySelectorAll('.image-card').forEach(card => {
          card.addEventListener('click', () => {
            const priority = card.dataset.priority;
            const selected = activityState.selectedPriorities || [];
            
            if (card.classList.contains('selected')) {
              card.classList.remove('selected');
              activityState.selectedPriorities = selected.filter(p => p !== priority);
            } else if (selected.length < 3) {
              card.classList.add('selected');
              activityState.selectedPriorities = [...selected, priority];
            }
            
            renderPrioritesMois();
          });
        });
        
        if (selectedPriorities.length === 3) {
          content.querySelector('#nextStep').addEventListener('click', () => {
            activityState.responses.selectedPriorities = activityState.selectedPriorities;
            activityState.step = 2;
            renderPrioritesMois();
          });
        }
      } else if (activityState.step === 2) {
        content.innerHTML = `
          <h2 class="activity-title">Tes 3 priorit√©s</h2>
          <div class="options-list">
            ${activityState.responses.selectedPriorities.map(priority => `
              <div class="option-item selected">
                <div class="checkbox"></div>
                <span>${priority}</span>
              </div>
            `).join('')}
          </div>
          <p style="font-size: 16px; font-weight: 700; margin: 24px 0;">
            La priorit√© n¬∞1 que je dois g√©rer est :
          </p>
          <input type="text" class="text-input" placeholder="Choisis parmi tes 3 priorit√©s..." id="topPriority">
          <button class="button-primary" id="finishActivity">Terminer</button>
        `;
        
        content.querySelector('#finishActivity').addEventListener('click', async () => {
          activityState.responses.topPriority = document.getElementById('topPriority').value;
          await saveActivity();
        });
      }
    }

    function renderEntreesSorties() {
      const content = document.getElementById('activityContent');
      
      if (activityState.step === 1) {
        const items = [
          'üíº RSA', 'üí∞ Salaire', 'üè† APL', 'üõí Courses', 'üì± Facture t√©l√©phone',
          'üöå Transport', 'üè° Loyer', 'üéÆ Loisirs', 'üë®‚Äçüë©‚Äçüëß Aides familiales', 'üí≥ Dettes'
        ];
        
        activityState.entreesItems = activityState.entreesItems || [];
        activityState.sortiesItems = activityState.sortiesItems || [];
        
        content.innerHTML = `
          <h2 class="activity-title">√áa rentre / √áa sort</h2>
          <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 24px;">
            Glisse chaque √©l√©ment dans la bonne colonne
          </p>
          
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 20px;">
            <div>
              <h3 style="text-align: center; color: #00D4AA; font-size: 18px; font-weight: 800; margin-bottom: 12px;">
                ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ √áa rentre
              </h3>
              <div class="drag-column" id="entreesArea" data-zone="entrees" style="border-color: #00D4AA; min-height: 250px;">
                ${activityState.entreesItems.map(item => `
                  <div class="draggable-item" draggable="true" data-item="${item}">${item}</div>
                `).join('')}
                ${activityState.entreesItems.length === 0 ? '<p style="color: #adb5bd; text-align: center; padding: 20px; font-size: 12px;">Glisse ici</p>' : ''}
              </div>
            </div>
            
            <div>
              <h3 style="text-align: center; color: #FF3B5C; font-size: 18px; font-weight: 800; margin-bottom: 12px;">
                üí∏ √áa sort
              </h3>
              <div class="drag-column" id="sortiesArea" data-zone="sorties" style="border-color: #FF3B5C; min-height: 250px;">
                ${activityState.sortiesItems.map(item => `
                  <div class="draggable-item" draggable="true" data-item="${item}">${item}</div>
                `).join('')}
                ${activityState.sortiesItems.length === 0 ? '<p style="color: #adb5bd; text-align: center; padding: 20px; font-size: 12px;">Glisse ici</p>' : ''}
              </div>
            </div>
          </div>
          
          <div style="background: #f8f9fa; border-radius: 16px; padding: 16px; display: flex; flex-wrap: wrap; gap: 8px; justify-content: center;">
            ${items.filter(item => !activityState.entreesItems.includes(item) && !activityState.sortiesItems.includes(item)).map(item => `
              <div class="draggable-item" draggable="true" data-item="${item}">${item}</div>
            `).join('')}
          </div>
          
          <button class="button-primary" id="nextStep" style="margin-top: 20px;">Suivant</button>
        `;
        
        setupDragAndDropEntreesSorties();
        
        content.querySelector('#nextStep').addEventListener('click', () => {
          activityState.responses.entreesItems = activityState.entreesItems;
          activityState.responses.sortiesItems = activityState.sortiesItems;
          activityState.step = 2;
          renderEntreesSorties();
        });
      } else if (activityState.step === 2) {
        content.innerHTML = `
          <h2 class="activity-title">Ta d√©pense √† surveiller</h2>
          
          <div style="margin-bottom: 24px;">
            <h3 style="color: #FF3B5C; font-size: 18px; font-weight: 700; margin-bottom: 12px;">
              üí∏ Ce qui sort :
            </h3>
            <div class="options-list">
              ${activityState.responses.sortiesItems.map(item => `
                <div class="option-item" style="border-color: #FF3B5C;">
                  <span>${item}</span>
                </div>
              `).join('')}
            </div>
          </div>
          
          <p style="font-size: 16px; font-weight: 700; margin: 24px 0;">
            La d√©pense que je dois surveiller le plus :
          </p>
          <input type="text" class="text-input" placeholder="Choisis parmi tes d√©penses..." id="mainExpense">
          
          <button class="button-primary" id="finishActivity">Terminer</button>
        `;
        
        content.querySelector('#finishActivity').addEventListener('click', async () => {
          activityState.responses.mainExpense = document.getElementById('mainExpense').value;
          await saveActivity();
        });
      }
    }

    function setupDragAndDropEntreesSorties() {
      const draggables = document.querySelectorAll('.draggable-item');
      const dropZones = document.querySelectorAll('.drag-column');
      
      draggables.forEach(item => {
        item.addEventListener('dragstart', (e) => {
          e.dataTransfer.effectAllowed = 'move';
          e.dataTransfer.setData('text/plain', item.dataset.item);
          item.classList.add('dragging');
        });
        
        item.addEventListener('dragend', () => {
          item.classList.remove('dragging');
        });
      });
      
      dropZones.forEach(zone => {
        zone.addEventListener('dragover', (e) => {
          e.preventDefault();
          e.dataTransfer.dropEffect = 'move';
        });
        
        zone.addEventListener('drop', (e) => {
          e.preventDefault();
          const itemText = e.dataTransfer.getData('text/plain');
          const draggingElement = document.querySelector('.draggable-item.dragging');
          
          if (draggingElement) {
            const zoneType = zone.dataset.zone;
            
            activityState.entreesItems = activityState.entreesItems.filter(i => i !== itemText);
            activityState.sortiesItems = activityState.sortiesItems.filter(i => i !== itemText);
            
            if (zoneType === 'entrees') {
              activityState.entreesItems.push(itemText);
            } else if (zoneType === 'sorties') {
              activityState.sortiesItems.push(itemText);
            }
            
            draggingElement.remove();
            renderEntreesSorties();
          }
        });
      });
    }

    function renderTrajetSansGalere() {
      const content = document.getElementById('activityContent');
      
      if (activityState.step === 1) {
        content.innerHTML = `
          <h2 class="activity-title">Mon trajet sans gal√®re</h2>
          <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 32px;">
            Choisis le trajet que tu dois pr√©parer
          </p>
          
          <div style="display: flex; flex-direction: column; gap: 16px; margin: 24px 0;">
            <button class="option-item" data-trajet="rdv-ml" style="cursor: pointer; border: 3px solid #00D4AA;">
              <span style="font-size: 32px; margin-right: 12px;">üè¢</span>
              <span style="font-size: 18px; font-weight: 700;">RDV √† la Mission Locale</span>
            </button>
            
            <button class="option-item" data-trajet="travail" style="cursor: pointer; border: 3px solid #FFD93D;">
              <span style="font-size: 32px; margin-right: 12px;">üíº</span>
              <span style="font-size: 18px; font-weight: 700;">Aller au travail</span>
            </button>
            
            <button class="option-item" data-trajet="stage" style="cursor: pointer; border: 3px solid #FF3B5C;">
              <span style="font-size: 32px; margin-right: 12px;">üéì</span>
              <span style="font-size: 18px; font-weight: 700;">Stage / Immersion</span>
            </button>
            
            <button class="option-item" data-trajet="formation" style="cursor: pointer; border: 3px solid #9B59B6;">
              <span style="font-size: 32px; margin-right: 12px;">üìö</span>
              <span style="font-size: 18px; font-weight: 700;">Formation</span>
            </button>
          </div>
        `;
        
        content.querySelectorAll('.option-item').forEach(btn => {
          btn.addEventListener('click', () => {
            activityState.responses.trajet = btn.dataset.trajet;
            activityState.step = 2;
            renderTrajetSansGalere();
          });
        });
      } else if (activityState.step === 2) {
        const trajetLabels = {
          'rdv-ml': 'RDV √† la Mission Locale',
          'travail': 'Aller au travail',
          'stage': 'Stage / Immersion',
          'formation': 'Formation'
        };
        
        content.innerHTML = `
          <h2 class="activity-title">Mon plan trajet</h2>
          <p style="text-align: center; font-size: 16px; font-weight: 700; color: #FF3B5C; margin-bottom: 32px;">
            ${trajetLabels[activityState.responses.trajet]}
          </p>
          
          <div style="display: flex; flex-direction: column; gap: 24px; margin: 24px 0;">
            <div style="background: linear-gradient(135deg, #00D4AA 0%, #00b894 100%); border-radius: 20px; padding: 24px;">
              <h3 style="font-size: 16px; font-weight: 800; color: white; margin: 0 0 12px 0;">
                üöå Comment j'y vais ?
              </h3>
              <input type="text" class="text-input" placeholder="Bus, v√©lo, marche, voiture..." id="howToGo" style="background: white;">
            </div>
            
            <div style="background: linear-gradient(135deg, #FFD93D 0%, #FFC107 100%); border-radius: 20px; padding: 24px;">
              <h3 style="font-size: 16px; font-weight: 800; color: #1a1a1a; margin: 0 0 12px 0;">
                ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ Quels impr√©vus possibles ?
              </h3>
              <textarea class="text-input" rows="3" placeholder="Bus en retard, crevaison, pas de place..." id="imprevu" style="background: white;"></textarea>
            </div>
            
            <div style="background: linear-gradient(135deg, #FF3B5C 0%, #e02e47 100%); border-radius: 20px; padding: 24px;">
              <h3 style="font-size: 16px; font-weight: 800; color: white; margin: 0 0 12px 0;">
                üîÑ Mon plan B
              </h3>
              <textarea class="text-input" rows="3" placeholder="Autre moyen de transport, contacter quelqu'un..." id="planB" style="background: white;"></textarea>
            </div>
          </div>
          
          <button class="button-primary" id="finishActivity">Terminer</button>
        `;
        
        content.querySelector('#finishActivity').addEventListener('click', async () => {
          activityState.responses.howToGo = document.getElementById('howToGo').value;
          activityState.responses.imprevu = document.getElementById('imprevu').value;
          activityState.responses.planB = document.getElementById('planB').value;
          await saveActivity();
        });
      }
    }

    function renderLieuBienEtre() {
      const content = document.getElementById('activityContent');
      
      if (activityState.step === 1) {
        const places = [
          { emoji: 'üõèÔ∏è', label: 'Ma chambre' },
          { emoji: 'üõãÔ∏è', label: 'Le salon' },
          { emoji: 'üë•', label: 'Chez un ami' },
          { emoji: 'üìö', label: 'Biblioth√®que' },
          { emoji: 'üè¢', label: 'Mission Locale' },
          { emoji: 'üå≥', label: 'Ext√©rieur calme' },
          { emoji: 'üçΩÔ∏è', label: 'La cuisine' },
          { emoji: 'üè†', label: 'Mon studio' },
          { emoji: 'üèõÔ∏è', label: 'Espace public' }
        ];
        
        const selectedPlaces = activityState.selectedPlaces || [];
        
        content.innerHTML = `
          <h2 class="activity-title">Mon lieu o√π je me sens bien</h2>
          <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 20px;">
            Choisis 1 ou 2 lieux o√π tu te sens en s√©curit√©/bien (${selectedPlaces.length}/2)
          </p>
          
          <div class="image-grid">
            ${places.map(place => `
              <div class="image-card ${selectedPlaces.includes(place.label) ? 'selected' : ''}" 
                   data-place="${place.label}">
                <div>
                  <div style="font-size: 48px;">${place.emoji}</div>
                  <div style="font-size: 12px; font-weight: 700; margin-top: 8px;">${place.label}</div>
                </div>
              </div>
            `).join('')}
          </div>
          
          <button class="button-primary" id="nextStep" ${selectedPlaces.length === 0 ? 'disabled' : ''}>
            Suivant
          </button>
        `;
        
        content.querySelectorAll('.image-card').forEach(card => {
          card.addEventListener('click', () => {
            const place = card.dataset.place;
            const selected = activityState.selectedPlaces || [];
            
            if (card.classList.contains('selected')) {
              card.classList.remove('selected');
              activityState.selectedPlaces = selected.filter(p => p !== place);
            } else if (selected.length < 2) {
              card.classList.add('selected');
              activityState.selectedPlaces = [...selected, place];
            }
            
            renderLieuBienEtre();
          });
        });
        
        if (selectedPlaces.length > 0) {
          content.querySelector('#nextStep').addEventListener('click', () => {
            activityState.responses.selectedPlaces = activityState.selectedPlaces;
            activityState.step = 2;
            renderLieuBienEtre();
          });
        }
      } else if (activityState.step === 2) {
        content.innerHTML = `
          <h2 class="activity-title">Ton lieu de bien-√™tre</h2>
          <div class="options-list">
            ${activityState.responses.selectedPlaces.map(place => `
              <div class="option-item selected">
                <div class="checkbox"></div>
                <span>${place}</span>
              </div>
            `).join('')}
          </div>
          <p style="font-size: 16px; font-weight: 700; margin: 24px 0;">
            Ce lieu m'aide parce que :
          </p>
          <textarea class="text-input" rows="5" placeholder="Explique pourquoi ce lieu te fait du bien..." id="placeReason"></textarea>
          <button class="button-primary" id="finishActivity">Terminer</button>
        `;
        
        content.querySelector('#finishActivity').addEventListener('click', async () => {
          activityState.responses.placeReason = document.getElementById('placeReason').value;
          await saveActivity();
        });
      }
    }

    function renderMesDroits() {
      const content = document.getElementById('activityContent');
      
      if (activityState.step === 1) {
        const rights = [
          { emoji: 'üè•', label: 'SantÔøΩÔøΩ' },
          { emoji: 'üè†', label: 'Logement' },
          { emoji: 'üöå', label: 'Transport' },
          { emoji: 'üéì', label: 'Formation' },
          { emoji: 'üí∞', label: 'Revenu' },
          { emoji: 'ü§ù', label: 'Accompagnement ML' }
        ];
        
        activityState.rightsStatus = activityState.rightsStatus || {};
        
        content.innerHTML = `
          <h2 class="activity-title">Mes droits du moment</h2>
          <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 32px;">
            Pour chaque droit, indique ta situation
          </p>
          
          ${rights.map((right, idx) => `
            <div style="background: #f8f9fa; border-radius: 20px; padding: 20px; margin-bottom: 16px;">
              <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 16px;">
                <div style="font-size: 48px;">${right.emoji}</div>
                <p style="font-size: 18px; font-weight: 700; color: #1a1a1a; margin: 0;">${right.label}</p>
              </div>
              <div style="display: flex; gap: 8px;">
                <button class="rights-btn ${activityState.rightsStatus[idx] === 'oui' ? 'selected' : ''}" 
                        data-right="${idx}" data-status="oui"
                        style="flex: 1; padding: 12px; background: ${activityState.rightsStatus[idx] === 'oui' ? '#00D4AA' : '#FFFFFF'}; 
                        color: ${activityState.rightsStatus[idx] === 'oui' ? '#FFFFFF' : '#00D4AA'}; 
                        border: 3px solid #00D4AA; border-radius: 12px; font-weight: 700; cursor: pointer; transition: all 0.3s ease;">
                  Oui, je l'ai
                </button>
                <button class="rights-btn ${activityState.rightsStatus[idx] === 'non' ? 'selected' : ''}" 
                        data-right="${idx}" data-status="non"
                        style="flex: 1; padding: 12px; background: ${activityState.rightsStatus[idx] === 'non' ? '#FF3B5C' : '#FFFFFF'}; 
                        color: ${activityState.rightsStatus[idx] === 'non' ? '#FFFFFF' : '#FF3B5C'}; 
                        border: 3px solid #FF3B5C; border-radius: 12px; font-weight: 700; cursor: pointer; transition: all 0.3s ease;">
                  Non
                </button>
                <button class="rights-btn ${activityState.rightsStatus[idx] === 'je-ne-sais-pas' ? 'selected' : ''}" 
                        data-right="${idx}" data-status="je-ne-sais-pas"
                        style="flex: 1; padding: 12px; background: ${activityState.rightsStatus[idx] === 'je-ne-sais-pas' ? '#FFD93D' : '#FFFFFF'}; 
                        color: ${activityState.rightsStatus[idx] === 'je-ne-sais-pas' ? '#1a1a1a' : '#FFD93D'}; 
                        border: 3px solid #FFD93D; border-radius: 12px; font-weight: 700; cursor: pointer; transition: all 0.3s ease;">
                  Je ne sais pas
                </button>
              </div>
            </div>
          `).join('')}
          
          <button class="button-primary" id="nextStep">Suivant</button>
        `;
        
        content.querySelectorAll('.rights-btn').forEach(btn => {
          btn.addEventListener('click', () => {
            const rightIdx = btn.dataset.right;
            const status = btn.dataset.status;
            activityState.rightsStatus[rightIdx] = status;
            renderMesDroits();
          });
        });
        
        content.querySelector('#nextStep').addEventListener('click', () => {
          activityState.responses.rightsStatus = activityState.rightsStatus;
          activityState.step = 2;
          renderMesDroits();
        });
      } else if (activityState.step === 2) {
        content.innerHTML = `
          <h2 class="activity-title">Droit √† v√©rifier</h2>
          <p style="font-size: 16px; font-weight: 700; margin: 24px 0;">
            Le droit √† v√©rifier en priorit√© :
          </p>
          <input type="text" class="text-input" placeholder="Quel droit tu veux v√©rifier..." id="priorityRight">
          <button class="button-primary" id="finishActivity">Terminer</button>
        `;
        
        content.querySelector('#finishActivity').addEventListener('click', async () => {
          activityState.responses.priorityRight = document.getElementById('priorityRight').value;
          await saveActivity();
        });
      }
    }

    function renderDemarche3Etapes() {
      const content = document.getElementById('activityContent');
      
      if (activityState.step === 1) {
        content.innerHTML = `
          <h2 class="activity-title">1 d√©marche = 3 √©tapes</h2>
          <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 32px;">
            Choisis la d√©marche que tu dois faire
          </p>
          
          <div style="display: flex; flex-direction: column; gap: 16px; margin: 24px 0;">
            <button class="option-item" data-demarche="cv-ml" style="cursor: pointer; border: 3px solid #00D4AA;">
              <span style="font-size: 32px; margin-right: 12px;">üìÑ</span>
              <span style="font-size: 18px; font-weight: 700;">CV Mission Locale</span>
            </button>
            
            <button class="option-item" data-demarche="dossier-sante" style="cursor: pointer; border: 3px solid #FFD93D;">
              <span style="font-size: 32px; margin-right: 12px;">üè•</span>
              <span style="font-size: 18px; font-weight: 700;">Dossier sant√©</span>
            </button>
            
            <button class="option-item" data-demarche="formation" style="cursor: pointer; border: 3px solid #FF3B5C;">
              <span style="font-size: 32px; margin-right: 12px;">üéì</span>
              <span style="font-size: 18px; font-weight: 700;">Inscription formation</span>
            </button>
            
            <button class="option-item" data-demarche="demande-aide" style="cursor: pointer; border: 3px solid #9B59B6;">
              <span style="font-size: 32px; margin-right: 12px;">üÜò</span>
              <span style="font-size: 18px; font-weight: 700;">Demande d'aide</span>
            </button>
          </div>
        `;
        
        content.querySelectorAll('.option-item').forEach(btn => {
          btn.addEventListener('click', () => {
            activityState.responses.demarche = btn.dataset.demarche;
            activityState.step = 2;
            renderDemarche3Etapes();
          });
        });
      } else if (activityState.step === 2) {
        const demarcheLabels = {
          'cv-ml': 'CV Mission Locale',
          'dossier-sante': 'Dossier sant√©',
          'formation': 'Inscription formation',
          'demande-aide': 'Demande d\'aide'
        };
        
        content.innerHTML = `
          <h2 class="activity-title">Mes 3 √©tapes</h2>
          <p style="text-align: center; font-size: 16px; font-weight: 700; color: #FF3B5C; margin-bottom: 32px;">
            ${demarcheLabels[activityState.responses.demarche]}
          </p>
          
          <div style="display: flex; flex-direction: column; gap: 24px; margin: 24px 0;">
            <div style="background: linear-gradient(135deg, #FF3B5C 0%, #e02e47 100%); border-radius: 20px; padding: 24px;">
              <h3 style="font-size: 16px; font-weight: 800; color: white; margin: 0 0 12px 0;">
                1Ô∏è‚É£ Ce qu'on me demande
              </h3>
              <textarea class="text-input" rows="3" placeholder="Liste ce qu'on te demande..." id="whatAsked" style="background: white;"></textarea>
            </div>
            
            <div style="background: linear-gradient(135deg, #FFD93D 0%, #FFC107 100%); border-radius: 20px; padding: 24px;">
              <h3 style="font-size: 16px; font-weight: 800; color: #1a1a1a; margin: 0 0 12px 0;">
                2Ô∏è‚É£ Ce que j'ai d√©j√†
              </h3>
              <textarea class="text-input" rows="3" placeholder="Ce que tu as d√©j√†..." id="whatIHave" style="background: white;"></textarea>
            </div>
            
            <div style="background: linear-gradient(135deg, #00D4AA 0%, #00b894 100%); border-radius: 20px; padding: 24px;">
              <h3 style="font-size: 16px; font-weight: 800; color: white; margin: 0 0 12px 0;">
                3Ô∏è‚É£ Ce qu'il me manque
              </h3>
              <textarea class="text-input" rows="3" placeholder="Ce qu'il te manque..." id="whatIMiss" style="background: white;"></textarea>
            </div>
          </div>
          
          <button class="button-primary" id="nextStep">Suivant</button>
        `;
        
        content.querySelector('#nextStep').addEventListener('click', () => {
          activityState.responses.whatAsked = document.getElementById('whatAsked').value;
          activityState.responses.whatIHave = document.getElementById('whatIHave').value;
          activityState.responses.whatIMiss = document.getElementById('whatIMiss').value;
          activityState.step = 3;
          renderDemarche3Etapes();
        });
      } else if (activityState.step === 3) {
        content.innerHTML = `
          <h2 class="activity-title">Qui peut m'aider ?</h2>
          
          <div style="display: flex; flex-direction: column; gap: 16px; margin: 24px 0;">
            <button class="option-item" data-help="ml" style="cursor: pointer;">
              <span style="font-size: 32px; margin-right: 12px;">üè¢</span>
              <span style="font-size: 18px; font-weight: 700;">Mission Locale</span>
            </button>
            
            <button class="option-item" data-help="famille" style="cursor: pointer;">
              <span style="font-size: 32px; margin-right: 12px;">üë®‚Äçüë©‚Äçüëß</span>
              <span style="font-size: 18px; font-weight: 700;">Famille</span>
            </button>
            
            <button class="option-item" data-help="pro" style="cursor: pointer;">
              <span style="font-size: 32px; margin-right: 12px;">üëî</span>
              <span style="font-size: 18px; font-weight: 700;">Professionnel</span>
            </button>
            
            <button class="option-item" data-help="autre" style="cursor: pointer;">
              <span style="font-size: 32px; margin-right: 12px;">üë•</span>
              <span style="font-size: 18px; font-weight: 700;">Autre</span>
            </button>
          </div>
        `;
        
        content.querySelectorAll('.option-item').forEach(btn => {
          btn.addEventListener('click', async () => {
            activityState.responses.helper = btn.dataset.help;
            await saveActivity();
          });
        });
      }
    }

    function renderEquipementBase() {
      const content = document.getElementById('activityContent');
      
      if (activityState.step === 1) {
        const equipments = [
          { emoji: 'üì±', label: 'T√©l√©phone qui marche' },
          { emoji: 'üîå', label: 'Chargeur' },
          { emoji: 'üì∂', label: 'Forfait t√©l√©phone' },
          { emoji: 'üí≥', label: 'Carte d\'identit√©' },
          { emoji: 'üè¶', label: 'RIB / compte bancaire' },
          { emoji: 'üè•', label: 'Carte vitale' }
        ];
        
        activityState.equipmentStatus = activityState.equipmentStatus || {};
        
        content.innerHTML = `
          <h2 class="activity-title">Mon √©quipement de base</h2>
          <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 32px;">
            Indique ce que tu as
          </p>
          
          ${equipments.map((equipment, idx) => `
            <div style="background: #f8f9fa; border-radius: 20px; padding: 20px; margin-bottom: 16px;">
              <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 16px;">
                <div style="font-size: 48px;">${equipment.emoji}</div>
                <p style="font-size: 16px; font-weight: 700; color: #1a1a1a; margin: 0;">${equipment.label}</p>
              </div>
              <div style="display: flex; gap: 8px;">
                <button class="equip-btn ${activityState.equipmentStatus[idx] === 'oui' ? 'selected' : ''}" 
                        data-equipment="${idx}" data-status="oui"
                        style="flex: 1; padding: 12px; background: ${activityState.equipmentStatus[idx] === 'oui' ? '#00D4AA' : '#FFFFFF'}; 
                        color: ${activityState.equipmentStatus[idx] === 'oui' ? '#FFFFFF' : '#00D4AA'}; 
                        border: 3px solid #00D4AA; border-radius: 12px; font-weight: 700; cursor: pointer; transition: all 0.3s ease;">
                  Oui, je l'ai
                </button>
                <button class="equip-btn ${activityState.equipmentStatus[idx] === 'non' ? 'selected' : ''}" 
                        data-equipment="${idx}" data-status="non"
                        style="flex: 1; padding: 12px; background: ${activityState.equipmentStatus[idx] === 'non' ? '#FF3B5C' : '#FFFFFF'}; 
                        color: ${activityState.equipmentStatus[idx] === 'non' ? '#FFFFFF' : '#FF3B5C'}; 
                        border: 3px solid #FF3B5C; border-radius: 12px; font-weight: 700; cursor: pointer; transition: all 0.3s ease;">
                  Non / √ßa manque
                </button>
              </div>
            </div>
          `).join('')}
          
          <button class="button-primary" id="nextStep">Suivant</button>
        `;
        
        content.querySelectorAll('.equip-btn').forEach(btn => {
          btn.addEventListener('click', () => {
            const equipIdx = btn.dataset.equipment;
            const status = btn.dataset.status;
            activityState.equipmentStatus[equipIdx] = status;
            renderEquipementBase();
          });
        });
        
        content.querySelector('#nextStep').addEventListener('click', () => {
          activityState.responses.equipmentStatus = activityState.equipmentStatus;
          activityState.step = 2;
          renderEquipementBase();
        });
      } else if (activityState.step === 2) {
        content.innerHTML = `
          <h2 class="activity-title">Ce qui me manque le plus</h2>
          <p style="font-size: 16px; font-weight: 700; margin: 24px 0;">
            L'ÔøΩÔøΩquipement qui me manque le plus :
          </p>
          <input type="text" class="text-input" placeholder="Ce dont tu as le plus besoin..." id="missingEquipment">
          <p style="font-size: 16px; font-weight: 700; margin: 24px 0;">
            O√π je peux l'obtenir / qui peut m'aider :
          </p>
          <textarea class="text-input" rows="4" placeholder="Mission Locale, famille, association..." id="whereToGet"></textarea>
          <button class="button-primary" id="finishActivity">Terminer</button>
        `;
        
        content.querySelector('#finishActivity').addEventListener('click', async () => {
          activityState.responses.missingEquipment = document.getElementById('missingEquipment').value;
          activityState.responses.whereToGet = document.getElementById('whereToGet').value;
          await saveActivity();
        });
      }
    }

    function renderRessourcesNumeriques() {
      const content = document.getElementById('activityContent');
      
      if (activityState.step === 1) {
        const resources = [
          { emoji: 'üíª', label: 'Ordinateur / tablette' },
          { emoji: 'üåê', label: 'Connexion internet' },
          { emoji: 'üìß', label: 'Email qui marche' },
          { emoji: 'üîë', label: 'Mot de passe que je connais' },
          { emoji: 'üì±', label: 'Applications utiles (ML, CAF...)' },
          { emoji: 'üìç', label: 'Endroit avec WiFi gratuit' }
        ];
        
        activityState.resourceStatus = activityState.resourceStatus || {};
        
        content.innerHTML = `
          <h2 class="activity-title">Mes ressources num√©riques</h2>
          <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 32px;">
            Indique ce que tu as
          </p>
          
          ${resources.map((resource, idx) => `
            <div style="background: #f8f9fa; border-radius: 20px; padding: 20px; margin-bottom: 16px;">
              <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 16px;">
                <div style="font-size: 48px;">${resource.emoji}</div>
                <p style="font-size: 16px; font-weight: 700; color: #1a1a1a; margin: 0;">${resource.label}</p>
              </div>
              <div style="display: flex; gap: 8px;">
                <button class="resource-btn ${activityState.resourceStatus[idx] === 'oui' ? 'selected' : ''}" 
                        data-resource="${idx}" data-status="oui"
                        style="flex: 1; padding: 12px; background: ${activityState.resourceStatus[idx] === 'oui' ? '#00D4AA' : '#FFFFFF'}; 
                        color: ${activityState.resourceStatus[idx] === 'oui' ? '#FFFFFF' : '#00D4AA'}; 
                        border: 3px solid #00D4AA; border-radius: 12px; font-weight: 700; cursor: pointer; transition: all 0.3s ease;">
                  Oui
                </button>
                <button class="resource-btn ${activityState.resourceStatus[idx] === 'non' ? 'selected' : ''}" 
                        data-resource="${idx}" data-status="non"
                        style="flex: 1; padding: 12px; background: ${activityState.resourceStatus[idx] === 'non' ? '#FF3B5C' : '#FFFFFF'}; 
                        color: ${activityState.resourceStatus[idx] === 'non' ? '#FFFFFF' : '#FF3B5C'}; 
                        border: 3px solid #FF3B5C; border-radius: 12px; font-weight: 700; cursor: pointer; transition: all 0.3s ease;">
                  Non
                </button>
              </div>
            </div>
          `).join('')}
          
          <button class="button-primary" id="nextStep">Suivant</button>
        `;
        
        content.querySelectorAll('.resource-btn').forEach(btn => {
          btn.addEventListener('click', () => {
            const resourceIdx = btn.dataset.resource;
            const status = btn.dataset.status;
            activityState.resourceStatus[resourceIdx] = status;
            renderRessourcesNumeriques();
          });
        });
        
        content.querySelector('#nextStep').addEventListener('click', () => {
          activityState.responses.resourceStatus = activityState.resourceStatus;
          activityState.step = 2;
          renderRessourcesNumeriques();
        });
      } else if (activityState.step === 2) {
        content.innerHTML = `
          <h2 class="activity-title">Ma ressource num√©rique prioritaire</h2>
          <p style="font-size: 16px; font-weight: 700; margin: 24px 0;">
            La ressource num√©rique dont j'ai le plus besoin :
          </p>
          <input type="text" class="text-input" placeholder="Ce qui te manque le plus..." id="priorityResource">
          <p style="font-size: 16px; font-weight: 700; margin: 24px 0;">
            O√π je peux y avoir acc√®s :
          </p>
          <textarea class="text-input" rows="4" placeholder="ML, biblioth√®que, cyber-base, chez un ami..." id="whereAccess"></textarea>
          <button class="button-primary" id="finishActivity">Terminer</button>
        `;
        
        content.querySelector('#finishActivity').addEventListener('click', async () => {
          activityState.responses.priorityResource = document.getElementById('priorityResource').value;
          activityState.responses.whereAccess = document.getElementById('whereAccess').value;
          await saveActivity();
        });
      }
    }

    function renderKitMinimum() {
      const content = document.getElementById('activityContent');
      
      if (activityState.step === 1) {
        const kitItems = [
          { emoji: 'üì±', label: 'T√©l√©phone qui marche' },
          { emoji: 'üîå', label: 'Chargeur' },
          { emoji: 'üì∂', label: 'Connexion internet' },
          { emoji: 'üí≥', label: 'Carte d\'identit√©' },
          { emoji: 'üè•', label: 'Carte vitale' },
          { emoji: 'üè†', label: 'Justificatif de domicile' },
          { emoji: 'üìÑ', label: 'CV √† jour' },
          { emoji: 'üìß', label: 'Acc√®s email' }
        ];
        
        activityState.kitStatus = activityState.kitStatus || {};
        
        content.innerHTML = `
          <h2 class="activity-title">Mon kit minimum</h2>
          <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 32px;">
            Coche ce que tu as d√©j√†
          </p>
          
          ${kitItems.map((item, idx) => `
            <div class="option-item ${activityState.kitStatus[idx] ? 'selected' : ''}" 
                 data-item="${idx}" 
                 style="cursor: pointer; margin-bottom: 12px;">
              <div class="checkbox"></div>
              <span style="font-size: 20px; margin-right: 12px;">${item.emoji}</span>
              <span style="font-weight: 700;">${item.label}</span>
            </div>
          `).join('')}
          
          <button class="button-primary" id="nextStep" style="margin-top: 24px;">Suivant</button>
        `;
        
        content.querySelectorAll('.option-item').forEach(item => {
          item.addEventListener('click', () => {
            const itemIdx = item.dataset.item;
            activityState.kitStatus[itemIdx] = !activityState.kitStatus[itemIdx];
            item.classList.toggle('selected');
          });
        });
        
        content.querySelector('#nextStep').addEventListener('click', () => {
          activityState.responses.kitStatus = activityState.kitStatus;
          activityState.step = 2;
          renderKitMinimum();
        });
      } else if (activityState.step === 2) {
        content.innerHTML = `
          <h2 class="activity-title">Ce qui me manque</h2>
          <p style="font-size: 16px; font-weight: 700; margin: 24px 0;">
            Ce qui me manque et que je dois r√©cup√©rer :
          </p>
          <textarea class="text-input" rows="6" placeholder="Liste ce qu'il te manque et comment tu vas l'obtenir..." id="missingKit"></textarea>
          <button class="button-primary" id="finishActivity">Terminer</button>
        `;
        
        content.querySelector('#finishActivity').addEventListener('click', async () => {
          activityState.responses.missingKit = document.getElementById('missingKit').value;
          await saveActivity();
        });
      }
    }

    function renderOuTrouver() {
      const content = document.getElementById('activityContent');
      
      if (activityState.step === 1) {
        const resources = [
          { 
            emoji: 'üè¢', 
            name: 'Mission Locale',
            help: 'Accompagnement, CV, aide administrative, orientation'
          },
          { 
            emoji: 'üèõÔ∏è', 
            name: 'CCAS',
            help: 'Aides sociales, d√©marches administratives, urgence'
          },
          { 
            emoji: 'üìö', 
            name: 'M√©diath√®que',
            help: 'WiFi gratuit, ordinateurs, imprimante, aide num√©rique'
          },
          { 
            emoji: 'üèòÔ∏è', 
            name: 'Centre social',
            help: 'Activit√©s, aide num√©rique, accompagnement social'
          },
          { 
            emoji: 'ÔøΩÔøΩÔøΩ‚Äçüë©‚Äçüëß', 
            name: 'Amis / Famille',
            help: 'Soutien, aide ponctuelle, h√©bergement temporaire'
          },
          { 
            emoji: 'ü§ù', 
            name: 'Associations locales',
            help: 'Aide mat√©rielle, vestimentaire, alimentaire, orientation'
          }
        ];
        
        content.innerHTML = `
          <h2 class="activity-title">O√π je peux trouver √ßa ?</h2>
          <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 24px;">
            D√©couvre les ressources pr√®s de chez toi
          </p>
          
          ${resources.map(resource => `
            <div style="background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%); 
                        border: 3px solid #00D4AA; border-radius: 20px; padding: 20px; margin-bottom: 16px;">
              <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 12px;">
                <div style="font-size: 48px;">${resource.emoji}</div>
                <h3 style="font-size: 18px; font-weight: 800; color: #1a1a1a; margin: 0;">${resource.name}</h3>
              </div>
              <p style="font-size: 14px; color: #6c757d; margin: 0; padding-left: 64px;">
                ${resource.help}
              </p>
            </div>
          `).join('')}
          
          <button class="button-primary" id="nextStep">Suivant</button>
        `;
        
        content.querySelector('#nextStep').addEventListener('click', () => {
          activityState.step = 2;
          renderOuTrouver();
        });
      } else if (activityState.step === 2) {
        content.innerHTML = `
          <h2 class="activity-title">Mon premier pas</h2>
          <p style="font-size: 16px; font-weight: 700; margin: 24px 0;">
            Je vais aller o√π en premier ?
          </p>
          <input type="text" class="text-input" placeholder="Choisis un lieu..." id="firstPlace">
          <p style="font-size: 16px; font-weight: 700; margin: 24px 0;">
            Pourquoi ce lieu peut m'aider :
          </p>
          <textarea class="text-input" rows="4" placeholder="Explique ce que tu esp√®res trouver..." id="whyPlace"></textarea>
          <button class="button-primary" id="finishActivity">Terminer</button>
        `;
        
        content.querySelector('#finishActivity').addEventListener('click', async () => {
          activityState.responses.firstPlace = document.getElementById('firstPlace').value;
          activityState.responses.whyPlace = document.getElementById('whyPlace').value;
          await saveActivity();
        });
      }
    }

    function renderGererImprevu() {
      const content = document.getElementById('activityContent');
      
      if (activityState.step === 1) {
        const scenarios = [
          { emoji: 'üì±üí•', label: 'T√©l√©phone cass√©', id: 'phone' },
          { emoji: 'üöå‚è∞', label: 'Bus en retard', id: 'bus' },
          { emoji: 'üìÑ‚ùå', label: 'Papier perdu', id: 'paper' },
          { emoji: 'üí∏üò∞', label: 'Facture impr√©vue', id: 'bill' }
        ];
        
        content.innerHTML = `
          <h2 class="activity-title">Je g√®re un impr√©vu</h2>
          <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 32px;">
            Choisis une situation
          </p>
          
          <div style="display: flex; flex-direction: column; gap: 16px; margin: 24px 0;">
            ${scenarios.map(scenario => `
              <button class="option-item" data-scenario="${scenario.id}" 
                      style="cursor: pointer; border: 3px solid #FF3B5C; justify-content: flex-start;">
                <span style="font-size: 32px; margin-right: 16px;">${scenario.emoji}</span>
                <span style="font-size: 18px; font-weight: 700;">${scenario.label}</span>
              </button>
            `).join('')}
          </div>
        `;
        
        content.querySelectorAll('.option-item').forEach(btn => {
          btn.addEventListener('click', () => {
            activityState.responses.scenario = btn.dataset.scenario;
            activityState.step = 2;
            renderGererImprevu();
          });
        });
      } else if (activityState.step === 2) {
        const scenarios = {
          phone: {
            title: 'üì±üí• T√©l√©phone cass√©',
            options: [
              { label: 'A) Je panique et je ne fais rien', feedback: 'C\'est normal de stresser, mais agir t\'aidera plus !' },
              { label: 'B) Je demande √† emprunter un t√©l√©phone √† quelqu\'un', feedback: '‚úì Bonne id√©e ! Tu trouves une solution rapide.' },
              { label: 'C) Je vais √† la Mission Locale expliquer la situation', feedback: '‚úì Excellent ! Ils peuvent t\'aider et te pr√™ter du mat√©riel.' }
            ]
          },
          bus: {
            title: 'üöå‚è∞ Bus en retard',
            options: [
              { label: 'A) J\'abandonne et je rentre chez moi', feedback: 'Dommage ! Tu peux trouver une autre solution.' },
              { label: 'B) J\'appelle pour pr√©venir que je serai en retard', feedback: '‚úì Super ! Pr√©venir montre que tu es responsable.' },
              { label: 'C) Je cherche un autre moyen (v√©lo, marche, covoiturage)', feedback: '‚úì G√©nial ! Tu t\'adaptes et tu cherches des alternatives.' }
            ]
          },
          paper: {
            title: 'üìÑ‚ùå Papier perdu',
            options: [
              { label: 'A) Je fais semblant de ne rien savoir', feedback: '√áa risque de compliquer les choses plus tard.' },
              { label: 'B) Je pr√©viens tout de suite et je demande comment refaire le papier', feedback: '‚úì Parfait ! Tu anticipes et tu trouves la solution.' },
              { label: 'C) Je note ce que je dois faire pour le r√©cup√©rer', feedback: '‚úì Bien vu ! Tu t\'organises pour r√©gler le probl√®me.' }
            ]
          },
          bill: {
            title: 'üí∏üò∞ Facture impr√©vue',
            options: [
              { label: 'A) J\'ignore la facture', feedback: 'Attention, √ßa risque d\'empirer la situation.' },
              { label: 'B) Je contacte l\'organisme pour demander un d√©lai', feedback: '‚úì Excellent ! Ils peuvent souvent trouver une solution avec toi.' },
              { label: 'C) Je demande de l\'aide √† la Mission Locale ou au CCAS', feedback: '‚úì Super id√©e ! Ils sont l√† pour t\'aider dans ces moments.' }
            ]
          }
        };
        
        const scenario = scenarios[activityState.responses.scenario];
        
        content.innerHTML = `
          <h2 class="activity-title">${scenario.title}</h2>
          <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 32px;">
            Comment tu r√©agis ?
          </p>
          
          <div style="display: flex; flex-direction: column; gap: 16px; margin: 24px 0;">
            ${scenario.options.map((option, idx) => `
              <button class="option-item reaction-choice" data-option="${idx}" 
                      style="cursor: pointer; border: 3px solid #00D4AA; align-items: flex-start; text-align: left;">
                <span style="font-weight: 700; line-height: 1.6;">${option.label}</span>
              </button>
            `).join('')}
          </div>
          
          <div id="feedbackArea" style="display: none; background: linear-gradient(135deg, #FFD93D 0%, #FFC107 100%); 
                  border-radius: 20px; padding: 24px; margin: 24px 0; text-align: center;">
            <p id="feedbackText" style="font-size: 16px; font-weight: 700; color: #1a1a1a; margin: 0;"></p>
          </div>
          
          <button class="button-primary" id="nextStep" style="display: none; margin-top: 24px;">Suivant</button>
        `;
        
        content.querySelectorAll('.reaction-choice').forEach(btn => {
          btn.addEventListener('click', () => {
            const optionIdx = parseInt(btn.dataset.option);
            const feedback = scenario.options[optionIdx].feedback;
            
            activityState.responses.chosenOption = optionIdx;
            activityState.responses.feedback = feedback;
            
            document.getElementById('feedbackArea').style.display = 'block';
            document.getElementById('feedbackText').textContent = feedback;
            document.getElementById('nextStep').style.display = 'block';
            
            content.querySelectorAll('.reaction-choice').forEach(b => b.style.opacity = '0.5');
            btn.style.opacity = '1';
            btn.style.borderColor = '#FFD93D';
          });
        });
        
        content.querySelector('#nextStep').addEventListener('click', () => {
          activityState.step = 3;
          renderGererImprevu();
        });
      } else if (activityState.step === 3) {
        content.innerHTML = `
          <h2 class="activity-title">Ma meilleure option</h2>
          <div style="background: #00D4AA; color: white; border-radius: 20px; padding: 20px; margin: 24px 0; text-align: center;">
            <p style="font-size: 16px; font-weight: 700; margin: 0;">
              ${activityState.responses.feedback}
            </p>
          </div>
          <p style="font-size: 16px; font-weight: 700; margin: 24px 0;">
            La meilleure option pour moi, c'est :
          </p>
          <textarea class="text-input" rows="5" placeholder="Explique comment tu g√®rerais cet impr√©vu..." id="bestOption"></textarea>
          <button class="button-primary" id="finishActivity">Terminer</button>
        `;
        
        content.querySelector('#finishActivity').addEventListener('click', async () => {
          activityState.responses.bestOption = document.getElementById('bestOption').value;
          await saveActivity();
        });
      }
    }

    function renderRessourcesSolides() {
      const content = document.getElementById('activityContent');
      
      if (activityState.step === 1) {
        content.innerHTML = `
          <h2 class="activity-title">Mes 3 ressources solides</h2>
          <p style="text-align: center; font-size: 14px; color: #6c757d; margin-bottom: 32px;">
            Identifie tes appuis
          </p>
          
          <div style="display: flex; flex-direction: column; gap: 24px; margin: 24px 0;">
            <div style="background: linear-gradient(135deg, #FF3B5C 0%, #e02e47 100%); border-radius: 20px; padding: 24px;">
              <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 16px;">
                <div style="font-size: 48px;">üë§</div>
                <h3 style="font-size: 20px; font-weight: 800; color: white; margin: 0;">Une personne</h3>
              </div>
              <input type="text" class="text-input" placeholder="Qui peut t'aider ? (conseiller, ami, famille...)" 
                     id="personResource" style="background: white;">
            </div>
            
            <div style="background: linear-gradient(135deg, #00D4AA 0%, #00b894 100%); border-radius: 20px; padding: 24px;">
              <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 16px;">
                <div style="font-size: 48px;">üìç</div>
                <h3 style="font-size: 20px; font-weight: 800; color: white; margin: 0;">Un lieu</h3>
              </div>
              <input type="text" class="text-input" placeholder="O√π tu peux aller ? (ML, biblioth√®que, association...)" 
                     id="placeResource" style="background: white;">
            </div>
            
            <div style="background: linear-gradient(135deg, #FFD93D 0%, #FFC107 100%); border-radius: 20px; padding: 24px;">
              <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 16px;">
                <div style="font-size: 48px;">üîß</div>
                <h3 style="font-size: 20px; font-weight: 800; color: #1a1a1a; margin: 0;">Un outil</h3>
              </div>
              <input type="text" class="text-input" placeholder="Quoi ? (t√©l√©phone, internet, transport, aide financi√®re...)" 
                     id="toolResource" style="background: white;">
            </div>
          </div>
          
          <button class="button-primary" id="nextStep">Suivant</button>
        `;
        
        content.querySelector('#nextStep').addEventListener('click', () => {
          activityState.responses.personResource = document.getElementById('personResource').value;
          activityState.responses.placeResource = document.getElementById('placeResource').value;
          activityState.responses.toolResource = document.getElementById('toolResource').value;
          activityState.step = 2;
          renderRessourcesSolides();
        });
      } else if (activityState.step === 2) {
        content.innerHTML = `
          <h2 class="activity-title">Mon mini-plan</h2>
          
          <div style="background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%); 
                      border: 3px solid #00D4AA; border-radius: 20px; padding: 24px; margin: 24px 0;">
            <h3 style="font-size: 18px; font-weight: 800; color: #FF3B5C; margin: 0 0 20px 0;">
              Mes 3 ressources :
            </h3>
            
            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px; padding: 16px; 
                        background: #fff; border-radius: 12px; border: 2px solid #FF3B5C;">
              <div style="font-size: 32px;">üë§</div>
              <div>
                <p style="font-size: 12px; color: #6c757d; margin: 0;">Personne</p>
                <p style="font-size: 16px; font-weight: 700; margin: 0;">${activityState.responses.personResource}</p>
              </div>
            </div>
            
            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px; padding: 16px; 
                        background: #fff; border-radius: 12px; border: 2px solid #00D4AA;">
              <div style="font-size: 32px;">üìç</div>
              <div>
                <p style="font-size: 12px; color: #6c757d; margin: 0;">Lieu</p>
                <p style="font-size: 16px; font-weight: 700; margin: 0;">${activityState.responses.placeResource}</p>
              </div>
            </div>
            
            <div style="display: flex; align-items: center; gap: 12px; padding: 16px; 
                        background: #fff; border-radius: 12px; border: 2px solid #FFD93D;">
              <div style="font-size: 32px;">üîß</div>
              <div>
                <p style="font-size: 12px; color: #6c757d; margin: 0;">Outil</p>
                <p style="font-size: 16px; font-weight: 700; margin: 0;">${activityState.responses.toolResource}</p>
              </div>
            </div>
          </div>
          
          <p style="font-size: 18px; font-weight: 800; color: #1a1a1a; margin: 24px 0; text-align: center;">
            Quand j'ai une difficult√©, je peux m'appuyer sur :
          </p>
          <textarea class="text-input" rows="6" placeholder="Explique comment ces 3 ressources peuvent t'aider..." id="supportPlan"></textarea>
          
          <button class="button-primary" id="finishActivity">Terminer</button>
        `;
        
        content.querySelector('#finishActivity').addEventListener('click', async () => {
          activityState.responses.supportPlan = document.getElementById('supportPlan').value;
          await saveActivity();
        });
      }
    }

    function renderDefaultActivity() {
      const content = document.getElementById('activityContent');
      content.innerHTML = `
        <h2 class="activity-title">Activit√© √† venir</h2>
        <p style="text-align: center; font-size: 16px; color: #6c757d;">
          Cette activit√© sera bient√¥t disponible !
        </p>
        <button class="button-secondary" id="closeModalBtn">Fermer</button>
      `;
      
      document.getElementById('closeModalBtn').addEventListener('click', closeModal);
    }

    async function saveActivity() {
      const createBtn = document.querySelector('#finishActivity, #responseYes, #responseNo');
      if (createBtn) {
        createBtn.disabled = true;
        createBtn.textContent = 'Enregistrement...';
      }

      const result = await window.dataSdk.create({
        activity_id: currentActivity.id,
        axis_number: currentActivity.axisId,
        competency_number: currentActivity.compId,
        responses: JSON.stringify(activityState.responses),
        completed_at: new Date().toISOString()
      });

      if (result.isOk) {
        completedActivities.add(currentActivity.id);
        
        const content = document.getElementById('activityContent');
        content.innerHTML = `
          <div style="text-align: center; padding: 40px 20px;">
            <div style="font-size: 72px; margin-bottom: 24px;">ÔøΩÔøΩ</div>
            <h2 style="font-size: 24px; font-weight: 800; color: #00D4AA; margin: 0 0 16px 0;">
              Activit√© terminÔøΩÔøΩe !
            </h2>
            <p style="font-size: 16px; color: #6c757d;">
              Tes r√©ponses ont √©t√© enregistr√©es.
            </p>
            <button class="button-primary" id="closeModalBtn" style="margin-top: 24px;">
              Continuer
            </button>
          </div>
        `;
        
        document.getElementById('closeModalBtn').addEventListener('click', () => {
          closeModal();
          renderAxisContent(currentAxis);
        });
      } else {
        if (createBtn) {
          createBtn.disabled = false;
          createBtn.textContent = 'Terminer';
        }
        
        const content = document.getElementById('activityContent');
        const errorMsg = document.createElement('div');
        errorMsg.style.cssText = 'background: #ff3b5c; color: white; padding: 12px; border-radius: 12px; margin-top: 16px; text-align: center;';
        errorMsg.textContent = 'Erreur lors de l\'enregistrement. R√©essaie.';
        content.appendChild(errorMsg);
      }
    }

    async function onConfigChange(config) {
      document.getElementById('mainTitle').textContent = config.main_title || defaultConfig.main_title;
      document.getElementById('subtitle').textContent = config.subtitle || defaultConfig.subtitle;
    }

    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities: (config) => ({
          recolorables: [],
          borderables: [],
          fontEditable: undefined,
          fontSizeable: undefined
        }),
        mapToEditPanelValues: (config) => new Map([
          ['main_title', config.main_title || defaultConfig.main_title],
          ['subtitle', config.subtitle || defaultConfig.subtitle]
        ])
      });
    }

    initializeApp();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9a80b827c56c2a43',t:'MTc2NDc0MDMyMy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
