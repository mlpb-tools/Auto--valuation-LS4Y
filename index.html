<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>LS4YOU ‚Äì Bilan Life Skills & Ressources</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    @import url("https://fonts.googleapis.com/css2?family=Poppins:wght@500;700&family=Nunito:wght@400;600;700&display=swap");

    :root {
      --orange: #f39200;
      --vert: #95c11f;
      --bleu: #2897d5;
      --rose: #d60b52;
      --violet: #a3195b;
      --rouge: #9f3d3f;
      --noir: #171718;
      --bg: #f5f5f7;
    }

    body {
      font-family: "Nunito", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at 0 0, #ffffff 0, #f7f7fb 35%, #ececf4 100%);
      color: var(--noir);
    }

    h1, h2, h3 {
      font-family: "Poppins", system-ui, sans-serif;
    }

    .card {
      border-radius: 18px;
      background: #ffffff;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
      border: 1px solid rgba(0, 0, 0, 0.04);
    }

    .chip {
      border-radius: 999px;
      font-size: 0.75rem;
      padding: 0.25rem 0.6rem;
      background: #f1f5f9;
    }

    .scale-dot {
      width: 46px;
      height: 46px;
      border-radius: 999px;
      border: 2px solid #e2e8f0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.18s ease;
      font-family: "Poppins", system-ui, sans-serif;
      font-size: 0.95rem;
      background: #fff;
    }

    .scale-dot:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 10px rgba(15, 23, 42, 0.12);
      border-color: var(--bleu);
    }

    .scale-dot.selected {
      background: var(--bleu);
      color: #fff;
      border-color: var(--bleu);
      box-shadow: 0 6px 14px rgba(37, 99, 235, 0.45);
    }

    .scale-label {
      font-size: 0.7rem;
      color: #6b7280;
    }

    .domain-pill {
      border-radius: 999px;
      padding: 0.24rem 0.7rem;
      font-size: 0.75rem;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 0.3rem;
    }

    .progress-bar {
      height: 0.8rem;
      border-radius: 999px;
      background: #e5e7eb;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--bleu), var(--rose));
      width: 0%;
      transition: width 0.4s ease;
    }

    .step-dot {
      width: 10px;
      height: 10px;
      border-radius: 999px;
      background: #e5e7eb;
      transition: all 0.2s ease;
    }

    .step-dot.active {
      background: var(--bleu);
      transform: scale(1.3);
    }

    .tag-weak {
      background: #fef2f2;
      color: #b91c1c;
    }

    .tag-ok {
      background: #fffbeb;
      color: #92400e;
    }

    .tag-strong {
      background: #ecfdf5;
      color: #166534;
    }

    @media (max-width: 768px) {
      .question-layout {
        flex-direction: column;
        align-items: flex-start;
      }
    }
  </style>
</head>
<body class="min-h-screen">

  <div class="max-w-5xl mx-auto px-4 py-6 md:py-10">
    <!-- Header -->
    <header class="mb-6 md:mb-10">
      <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
        <div>
          <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white shadow-sm border border-slate-100 mb-2">
            <span class="text-xs font-semibold uppercase tracking-wide text-slate-500">Mission Locale Pays Basque</span>
            <span class="w-1 h-1 rounded-full bg-slate-300"></span>
            <span class="text-xs text-slate-500">LS4YOU ‚Äì Life Skills</span>
          </div>
          <h1 class="text-2xl md:text-3xl font-bold text-slate-900">
            Bilan Life Skills & ressources d‚Äôorientation
          </h1>
          <p class="mt-2 text-sm md:text-base text-slate-600 max-w-2xl">
            Un outil commun <span class="font-semibold">jeune / conseiller</span> pour rep√©rer les forces,
            les besoins et les ressources √† mobiliser dans le cadre du <span class="font-semibold">CEP</span>.
          </p>
        </div>
        <div class="card px-4 py-3 flex flex-col gap-2 md:w-64">
          <div class="flex items-center justify-between">
            <span class="text-xs font-semibold text-slate-500 uppercase tracking-wide">
              Questions r√©pondues
            </span>
            <span id="progress-counter" class="text-sm font-semibold text-slate-900">
              0 / 50
            </span>
          </div>
          <div class="progress-bar">
            <div id="progress-fill" class="progress-fill"></div>
          </div>
          <div class="flex items-center justify-between text-[0.7rem] text-slate-500">
            <span>Pour le jeune</span>
            <span>Pour le conseiller</span>
          </div>
        </div>
      </div>
    </header>

    <!-- Main Card -->
    <main class="card p-4 md:p-6">
      <!-- Top info / steps -->
      <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3 mb-4 md:mb-6">
        <div class="flex items-center gap-3">
          <div class="w-9 h-9 rounded-2xl bg-slate-900 text-white flex items-center justify-center text-sm font-bold">
            <span id="domain-index">1</span>/11
          </div>
          <div>
            <p class="text-xs font-semibold uppercase tracking-wide text-slate-500">
              Domaine en cours
            </p>
            <h2 id="domain-title" class="text-base md:text-lg font-semibold text-slate-900">
              <!-- rempli en JS -->
            </h2>
          </div>
        </div>
        <div class="flex items-center gap-2">
          <div class="flex items-center gap-1" id="step-dots">
            <!-- rempli en JS -->
          </div>
          <span class="text-[0.7rem] text-slate-500 hidden md:inline">Parcours des 11 domaines</span>
        </div>
      </div>

      <!-- Description domaine -->
      <div class="mb-4 border border-dashed border-slate-200 rounded-2xl px-3.5 py-3 bg-slate-50">
        <p id="domain-description" class="text-sm text-slate-700">
          <!-- rempli en JS -->
        </p>
      </div>

      <!-- Questions -->
      <div id="questions-container" class="space-y-3 md:space-y-4 mb-6">
        <!-- rempli en JS -->
      </div>

      <!-- L√©gende √©chelle -->
      <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-2 mb-4">
        <div class="flex items-center gap-2 text-[0.7rem] text-slate-500">
          <span class="scale-dot !w-7 !h-7 !border-slate-300 cursor-default text-[0.75rem]">1</span>
          <span>Pas du tout moi</span>
          <span class="scale-dot !w-7 !h-7 !border-slate-300 cursor-default text-[0.75rem]">4</span>
          <span>Tout √† fait moi</span>
        </div>
        <div class="flex flex-wrap gap-1 text-[0.7rem]">
          <span class="chip">R√©pondre spontan√©ment</span>
          <span class="chip">Le conseiller peut reformuler</span>
          <span class="chip">Aucun jugement ‚Äì juste un rep√®re</span>
        </div>
      </div>

      <!-- Navigation -->
      <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3">
        <button id="prev-btn"
                class="w-full md:w-auto inline-flex items-center justify-center gap-1 px-4 py-2.5 rounded-xl border border-slate-300 text-sm font-semibold text-slate-700 hover:bg-slate-50 disabled:opacity-40 disabled:cursor-not-allowed">
          ‚Üê Domaine pr√©c√©dent
        </button>
        <div class="text-xs text-slate-500 text-center md:text-left">
          Tu peux revenir en arri√®re √† tout moment. Les r√©ponses sont sauvegard√©es sur cette page.
        </div>
        <button id="next-btn"
                class="w-full md:w-auto inline-flex items-center justify-center gap-1 px-4 py-2.5 rounded-xl bg-slate-900 text-sm font-semibold text-white hover:bg-slate-800">
          Domaine suivant ‚Üí
        </button>
      </div>

      <!-- Bouton r√©sultats -->
      <div class="mt-6 border-t border-slate-100 pt-4 flex justify-end">
        <button id="results-btn"
                class="inline-flex items-center justify-center gap-2 px-4 py-2.5 rounded-xl bg-[var(--bleu)] text-sm font-semibold text-white hover:brightness-110 disabled:opacity-40 disabled:cursor-not-allowed"
                disabled>
          Voir mon bilan complet üìä
        </button>
      </div>
    </main>

    <!-- R√©sultats -->
    <section id="results-section" class="mt-8 hidden">
      <div class="card p-4 md:p-6 mb-4">
        <h2 class="text-lg md:text-xl font-bold text-slate-900 mb-1">
          Bilan Life Skills & Ressources ‚Äì Synth√®se par domaine
        </h2>
        <p class="text-sm text-slate-600 mb-4">
          Ce bilan n‚Äôest pas un jugement. C‚Äôest un support de dialogue entre le jeune et le conseiller
          pour construire un <span class="font-semibold">plan d‚Äôactions CEP</span> r√©aliste et motivant.
        </p>

        <div class="overflow-x-auto">
          <table class="min-w-full text-sm border-t border-b border-slate-100">
            <thead class="bg-slate-50">
              <tr>
                <th class="text-left px-3 py-2 font-semibold text-slate-600">Domaine</th>
                <th class="text-left px-3 py-2 font-semibold text-slate-600">Score (1‚Äì4)</th>
                <th class="text-left px-3 py-2 font-semibold text-slate-600">Lecture rapide</th>
                <th class="text-left px-3 py-2 font-semibold text-slate-600">Pistes Life Skills & CEP</th>
              </tr>
            </thead>
            <tbody id="results-table-body" class="divide-y divide-slate-100">
              <!-- rempli en JS -->
            </tbody>
          </table>
        </div>
      </div>

      <div class="grid gap-4 md:grid-cols-2">
        <div class="card p-4">
          <h3 class="text-sm font-semibold text-slate-900 mb-2">Pour le jeune ‚Äì Ce que je peux retenir</h3>
          <p class="text-xs text-slate-600 mb-2">
            Utilise ces phrases comme base d‚Äô√©change avec ton conseiller :
          </p>
          <ul id="youth-summary" class="list-disc list-inside text-xs text-slate-700 space-y-1">
            <!-- rempli en JS -->
          </ul>
        </div>
        <div class="card p-4">
          <h3 class="text-sm font-semibold text-slate-900 mb-2">Pour le conseiller ‚Äì Rep√®res pour le CEP</h3>
          <p class="text-xs text-slate-600 mb-2">
            Les scores ‚â§ 2,0 indiquent des domaines √† approfondir et/ou √† s√©curiser dans le plan d‚Äôactions.
          </p>
          <ul id="counsellor-summary" class="list-disc list-inside text-xs text-slate-700 space-y-1">
            <!-- rempli en JS -->
          </ul>
        </div>
      </div>
    </section>

  </div>

  <script>
    // --- Configuration des domaines et questions ---
    const domains = [
      {
        id: "emploi",
        title: "Emploi ‚Äì acc√®s, posture, recherche",
        color: "bg-sky-100 text-sky-800",
        description:
          "Comment tu te sens par rapport au monde du travail : te pr√©senter, chercher un job, tenir un poste, interagir avec des employeurs.",
        questions: [
          "Je me sens capable d‚Äôexpliquer clairement ce que je peux apporter √† un employeur.",
          "L‚Äôid√©e de passer un entretien d‚Äôembauche me met tr√®s mal √† l‚Äôaise.",
          "Je sais o√π chercher des offres d‚Äôemploi ou d‚Äôapprentissage qui m‚Äôint√©ressent.",
          "Je suis √† l‚Äôaise pour respecter des consignes et un cadre de travail.",
          "Je sais demander de l‚Äôaide si je suis perdu au travail ou en stage."
        ]
      },
      {
        id: "formation",
        title: "Formation ‚Äì apprentissages, rythme, engagement",
        color: "bg-amber-100 text-amber-900",
        description:
          "Ta capacit√© √† entrer, suivre et tenir une formation (rythme, organisation, exigences, examens‚Ä¶).",
        questions: [
          "Je me vois capable de suivre une formation plusieurs semaines ou mois.",
          "Je r√©ussis √† rester concentr√©(e) en cours ou en atelier.",
          "Je sais demander des explications quand je ne comprends pas.",
          "Je peux g√©rer le stress avant un examen, un contr√¥le ou une √©valuation.",
          "Je suis pr√™t(e) √† m‚Äôengager s√©rieusement dans une formation si elle a du sens pour moi."
        ]
      },
      {
        id: "orientation",
        title: "Orientation professionnelle ‚Äì projet, cap, d√©cisions",
        color: "bg-violet-100 text-violet-900",
        description:
          "O√π tu en es dans ton projet : envies, id√©es, choix, d√©cisions, capacit√© √† te projeter.",
        questions: [
          "J‚Äôai au moins une id√©e de m√©tier ou de domaine qui m‚Äôint√©resse vraiment.",
          "Je sais dire ce que j‚Äôaime et ce que je n‚Äôaime pas dans le travail ou les √©tudes.",
          "Je prends en compte mes forces et mes limites quand je r√©fl√©chis √† mon avenir.",
          "Je me sens capable de faire des choix importants pour mon avenir, avec de l‚Äôaide si besoin.",
          "Je vois √† peu pr√®s les √©tapes pour avancer vers mon projet (m√™me si tout n‚Äôest pas clair)."
        ]
      },
      {
        id: "mobilite",
        title: "Mobilit√© ‚Äì d√©placements, autonomie, acc√®s aux lieux",
        color: "bg-emerald-100 text-emerald-900",
        description:
          "Comment tu te d√©places (transports, trajets, autonomie) pour acc√©der √† l‚Äôemploi, la formation, les loisirs, les soins‚Ä¶",
        questions: [
          "Je peux me rendre sans trop de difficult√©s aux rendez-vous importants (Mission Locale, m√©decin, formation‚Ä¶).",
          "Je connais les solutions de transport possibles autour de chez moi (bus, train, covoiturage‚Ä¶).",
          "Je me sens √† l‚Äôaise pour organiser un trajet dans un endroit que je ne connais pas.",
          "Les questions de transport repr√©sentent un vrai frein pour certains projets qui m‚Äôint√©ressent.",
          "Je sais √† qui parler si j‚Äôai un probl√®me de permis, v√©hicule ou titres de transport."
        ]
      },
      {
        id: "sante",
        title: "Sant√© physique & mentale ‚Äì √©nergie, √©motion, bien-√™tre",
        color: "bg-rose-100 text-rose-900",
        description:
          "Comment tu te sens dans ton corps et dans ta t√™te : sommeil, stress, √©motions, √©nergie, sant√© globale.",
        questions: [
          "J‚Äôai globalement un niveau d‚Äô√©nergie suffisant pour mes activit√©s du quotidien.",
          "Je rep√®re quand mon stress ou mes √©motions commencent √† d√©border.",
          "Je connais au moins une ou deux choses qui m‚Äôaident √† me calmer ou √† me recentrer.",
          "Je sais vers qui me tourner si je ne vais pas bien (pro, proche, structure‚Ä¶).",
          "Ma sant√© (physique ou mentale) rend parfois difficile le fait de tenir des engagements (rdv, formation, travail‚Ä¶)."
        ]
      },
      {
        id: "logement",
        title: "Logement & environnement de vie",
        color: "bg-slate-100 text-slate-800",
        description:
          "Ton cadre de vie : logement, stabilit√©, environnement pour te poser, te reposer, travailler.",
        questions: [
          "Aujourd‚Äôhui, j‚Äôai un endroit o√π je peux dormir en s√©curit√©.",
          "Mon environnement de vie me permet de me reposer correctement.",
          "Mon logement / lieu de vie rend possible un projet de formation ou d‚Äôemploi.",
          "Je sais vers qui me tourner si ma situation de logement devenait compliqu√©e."
        ]
      },
      {
        id: "citoyennete",
        title: "Citoyennet√©, relations & participation",
        color: "bg-indigo-100 text-indigo-900",
        description:
          "Ta place dans la soci√©t√© : relations avec les autres, participation, droits, engagement, vie collective.",
        questions: [
          "Je me sens √† l‚Äôaise pour √©changer dans un groupe (atelier, association, formation‚Ä¶).",
          "Je connais au moins un lieu ou dispositif o√π la parole des jeunes est prise en compte.",
          "Je sais faire respecter mes droits sans me mettre en danger (ou avec un soutien).",
          "Je suis pr√™t(e) √† m‚Äôengager dans une activit√© utile (b√©n√©volat, projet collectif, service civique‚Ä¶)."
        ]
      },
      {
        id: "finances",
        title: "Ressources financi√®res & budget",
        color: "bg-amber-50 text-amber-900",
        description:
          "Ta relation √† l‚Äôargent, la gestion de ton budget, ta capacit√© √† faire face aux d√©penses du quotidien et aux projets.",
        questions: [
          "Je sais √† peu pr√®s combien d‚Äôargent entre et sort chaque mois.",
          "Je rep√®re les moments o√π ma situation financi√®re devient fragile.",
          "Je peux parler d‚Äôargent avec un adulte ou un professionnel sans trop de g√™ne.",
          "Je sais que certaines aides financi√®res existent (allocations, aides logement, mobilit√©‚Ä¶).",
          "Ma situation financi√®re limite aujourd‚Äôhui certains projets (permis, logement, formation, loisirs‚Ä¶)."
        ]
      },
      {
        id: "loisirs",
        title: "Loisirs, sport & culture",
        color: "bg-teal-50 text-teal-900",
        description:
          "Ce qui te permet de souffler, de t‚Äôexprimer, de te sentir bien (sport, activit√©s cr√©atives, sorties, culture‚Ä¶).",
        questions: [
          "J‚Äôai au moins une activit√© qui me fait du bien (sport, musique, jeu, cr√©ation, etc.).",
          "Je prends un minimum de temps pour moi dans la semaine.",
          "Je d√©couvre parfois de nouvelles activit√©s, lieux ou personnes.",
          "Je vois un lien entre certains de mes loisirs et mon projet d‚Äôavenir (comp√©tences, r√©seau, id√©es‚Ä¶)."
        ]
      },
      {
        id: "numerique",
        title: "Num√©rique ‚Äì outils, acc√®s, usages",
        color: "bg-cyan-50 text-cyan-900",
        description:
          "Ton acc√®s aux outils num√©riques (t√©l√©phone, internet, ordinateur) et ta capacit√© √† les utiliser pour tes projets.",
        questions: [
          "J‚Äôai acc√®s r√©guli√®rement √† un t√©l√©phone et √† internet.",
          "Je me d√©brouille pour faire des d√©marches en ligne, avec ou sans aide.",
          "Je me sens capable d‚Äôutiliser le num√©rique pour chercher de l‚Äôinfo (emploi, formation, sant√©‚Ä¶).",
          "Je fais attention √† ce que j‚Äôenvoie ou publie en ligne (image, donn√©es perso‚Ä¶)."
        ]
      },
      {
        id: "mode_vie",
        title: "Mode de vie & organisation du quotidien",
        color: "bg-lime-50 text-lime-900",
        description:
          "Ton rythme de vie de tous les jours : sommeil, alimentation, horaires, organisation, d√©placements‚Ä¶",
        questions: [
          "Globalement, mes horaires de sommeil me permettent de tenir mes journ√©es.",
          "Je suis capable d‚Äôarriver √† l‚Äôheure quand quelque chose est important pour moi.",
          "Je m‚Äôorganise (un minimum) pour mes rendez-vous, papiers, d√©marches.",
          "Je vois ce que je pourrais am√©liorer dans mon rythme de vie pour avancer dans mes projets.",
          "Je suis pr√™t(e) √† tester de petits changements (horaires, habitudes) si √ßa m‚Äôaide √† atteindre un objectif."
        ]
      }
    ];

    const TOTAL_QUESTIONS = domains.reduce((sum, d) => sum + d.questions.length, 0);

    let currentDomainIndex = 0;
    const answers = {}; // { "emploi_0": 1..4, ... }

    const domainIndexEl = document.getElementById("domain-index");
    const domainTitleEl = document.getElementById("domain-title");
    const domainDescEl = document.getElementById("domain-description");
    const questionsContainer = document.getElementById("questions-container");
    const stepDotsContainer = document.getElementById("step-dots");
    const prevBtn = document.getElementById("prev-btn");
    const nextBtn = document.getElementById("next-btn");
    const resultsBtn = document.getElementById("results-btn");
    const progressFill = document.getElementById("progress-fill");
    const progressCounter = document.getElementById("progress-counter");
    const resultsSection = document.getElementById("results-section");
    const resultsTableBody = document.getElementById("results-table-body");
    const youthSummaryEl = document.getElementById("youth-summary");
    const counsellorSummaryEl = document.getElementById("counsellor-summary");

    // Cr√©e les petits points de progression (11 domaines)
    function renderStepDots() {
      stepDotsContainer.innerHTML = "";
      domains.forEach((d, idx) => {
        const dot = document.createElement("button");
        dot.type = "button";
        dot.className = "step-dot" + (idx === currentDomainIndex ? " active" : "");
        dot.title = d.title;
        dot.addEventListener("click", () => {
          currentDomainIndex = idx;
          renderDomain();
        });
        stepDotsContainer.appendChild(dot);
      });
    }

    function renderDomain() {
      const domain = domains[currentDomainIndex];
      domainIndexEl.textContent = currentDomainIndex + 1;
      domainTitleEl.textContent = domain.title;
      domainDescEl.textContent = domain.description;

      // update dots
      renderStepDots();

      // navigation buttons
      prevBtn.disabled = currentDomainIndex === 0;
      nextBtn.textContent = currentDomainIndex === domains.length - 1 ? "Finir les questions ‚Üí" : "Domaine suivant ‚Üí";

      // questions
      questionsContainer.innerHTML = "";
      domain.questions.forEach((qText, i) => {
        const qId = `${domain.id}_${i}`;
        const selectedValue = answers[qId];

        const wrapper = document.createElement("div");
        wrapper.className = "flex question-layout items-center justify-between gap-4 rounded-2xl border border-slate-100 bg-white px-3.5 py-3";

        const left = document.createElement("div");
        left.className = "flex-1";
        const label = document.createElement("p");
        label.className = "text-sm text-slate-800";
        label.textContent = qText;
        left.appendChild(label);

        const right = document.createElement("div");
        right.className = "flex flex-col items-center gap-1";
        const scale = document.createElement("div");
        scale.className = "flex items-center gap-1.5";

        for (let lvl = 1; lvl <= 4; lvl++) {
          const btn = document.createElement("button");
          btn.type = "button";
          btn.className = "scale-dot" + (selectedValue === lvl ? " selected" : "");
          btn.textContent = lvl;
          btn.setAttribute("aria-label", `Niveau ${lvl} pour cette affirmation`);
          btn.addEventListener("click", () => {
            answers[qId] = lvl;
            renderDomain();
            updateProgress();
          });
          scale.appendChild(btn);
        }

        const scaleLegend = document.createElement("div");
        scaleLegend.className = "flex justify-between w-full text-[0.6rem] text-slate-500";
        scaleLegend.innerHTML = `
          <span>Pas du tout moi</span>
          <span>Tout √† fait moi</span>
        `;

        right.appendChild(scale);
        right.appendChild(scaleLegend);

        wrapper.appendChild(left);
        wrapper.appendChild(right);
        questionsContainer.appendChild(wrapper);
      });

      updateProgress();
    }

    function updateProgress() {
      const answeredCount = Object.keys(answers).length;
      const percent = (answeredCount / TOTAL_QUESTIONS) * 100;
      progressFill.style.width = `${percent}%`;
      progressCounter.textContent = `${answeredCount} / ${TOTAL_QUESTIONS}`;

      // bouton r√©sultats activ√© si au moins 60 % compl√©t√©
      resultsBtn.disabled = answeredCount < Math.round(TOTAL_QUESTIONS * 0.6);
    }

    prevBtn.addEventListener("click", () => {
      if (currentDomainIndex > 0) {
        currentDomainIndex--;
        renderDomain();
      }
    });

    nextBtn.addEventListener("click", () => {
      if (currentDomainIndex < domains.length - 1) {
        currentDomainIndex++;
        renderDomain();
      }
    });

    resultsBtn.addEventListener("click", () => {
      buildResults();
      resultsSection.classList.remove("hidden");
      resultsSection.scrollIntoView({ behavior: "smooth" });
    });

    function computeDomainScore(domain) {
      const scores = [];
      domain.questions.forEach((qText, i) => {
        const qId = `${domain.id}_${i}`;
        const val = answers[qId];
        if (typeof val === "number") scores.push(val);
      });
      if (!scores.length) return null;
      const avg = scores.reduce((a, b) => a + b, 0) / scores.length;
      return avg;
    }

    function levelTag(score) {
      if (score === null) {
        return { label: "Non renseign√©", class: "chip" };
      } else if (score < 2) {
        return { label: "√Ä s√©curiser", class: "chip tag-weak" };
      } else if (score < 3) {
        return { label: "√Ä accompagner", class: "chip tag-ok" };
      } else {
        return { label: "Point d‚Äôappui", class: "chip tag-strong" };
      }
    }

    // Pistes g√©n√©riques par domaine (lecture pro)
    const domainHints = {
      emploi: "Travailler la pr√©sentation de soi, les simulations d‚Äôentretien, la d√©couverte des m√©tiers et des environnements de travail.",
      formation: "Explorer les dispositifs de formation adapt√©s, s√©curiser le rythme (soutien, tutorat), travailler la motivation et l‚Äôanticipation.",
      orientation: "Clarifier les int√©r√™ts, valeurs et contraintes, multiplier les rencontres m√©tiers, co-construire un cap r√©aliste et r√©versible.",
      mobilite: "Rep√©rer les freins de transport, mobiliser les aides et solutions (transport, permis, v√©lo, covoiturage), s√©curiser les trajets.",
      sante: "Prendre en compte le rythme de vie, orienter si besoin vers des ressources sant√©, am√©nager les parcours pour pr√©venir les ruptures.",
      logement: "√âvaluer la stabilit√©, informer sur les dispositifs logement/urgence/accompagnement, articuler projet et contraintes de vie.",
      citoyennete: "S‚Äôappuyer sur des espaces d‚Äôexpression (collectifs jeunes, service civique, associations) pour renforcer confiance et pouvoir d‚Äôagir.",
      finances: "Travailler le budget, orienter vers les aides, s√©curiser les ressources sur les temps de transition (formation, mobilit√©, logement‚Ä¶).",
      loisirs: "Identifier les activit√©s qui soutiennent le bien-√™tre, la confiance, voire des comp√©tences transf√©rables au projet professionnel.",
      numerique: "S‚Äôassurer de l‚Äôacc√®s aux outils, accompagner les d√©marches en ligne, travailler les usages responsables et l‚Äôidentit√© num√©rique.",
      mode_vie: "Aborder sommeil, horaires, alimentation, d√©placements, et voir comment ajuster le quotidien pour rendre les projets tenables."
    };

    function buildResults() {
      resultsTableBody.innerHTML = "";
      const youthLines = [];
      const counsellorLines = [];

      domains.forEach((domain) => {
        const score = computeDomainScore(domain);
        const tag = levelTag(score);

        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td class="px-3 py-2 align-top">
            <div class="flex items-center gap-2">
              <span class="domain-pill ${domain.color}">
                ${domain.title.split("‚Äì")[0].trim()}
              </span>
            </div>
          </td>
          <td class="px-3 py-2 align-top">
            ${
              score === null
                ? '<span class="text-xs italic text-slate-400">Non renseign√©</span>'
                : `<div class="flex items-center gap-2">
                     <span class="text-sm font-semibold text-slate-900">${score.toFixed(1)} / 4</span>
                     <span class="${tag.class}">${tag.label}</span>
                   </div>`
            }
          </td>
          <td class="px-3 py-2 align-top text-xs text-slate-700">
            ${domain.description}
          </td>
          <td class="px-3 py-2 align-top text-xs text-slate-700">
            ${domainHints[domain.id] || ""}
          </td>
        `;
        resultsTableBody.appendChild(tr);

        if (score !== null) {
          if (score >= 3) {
            youthLines.push(
              `‚Ä¢ <strong>${domain.title.split("‚Äì")[0].trim()}</strong> : un domaine o√π je peux m‚Äôappuyer sur mes forces.`
            );
          } else if (score < 2) {
            youthLines.push(
              `‚Ä¢ <strong>${domain.title.split("‚Äì")[0].trim()}</strong> : un domaine √† s√©curiser, √† travailler pas √† pas avec mon/ma conseiller(√®re).`
            );
          } else {
            youthLines.push(
              `‚Ä¢ <strong>${domain.title.split("‚Äì")[0].trim()}</strong> : un domaine √† accompagner, o√π j‚Äôai d√©j√† des bases mais aussi des besoins.`
            );
          }

          if (score < 2.5) {
            counsellorLines.push(
              `‚Ä¢ <strong>${domain.title.split("‚Äì")[0].trim()}</strong> : approfondir en entretien (score ${score.toFixed(
                1
              )}/4) et int√©grer des actions sp√©cifiques dans le plan CEP.`
            );
          }
        }
      });

      youthSummaryEl.innerHTML = youthLines.length
        ? youthLines.join("<br/>")
        : '<li class="italic text-slate-500">Compl√©ter davantage le questionnaire pour obtenir un retour personnalis√©.</li>';

      counsellorSummaryEl.innerHTML = counsellorLines.length
        ? counsellorLines.join("<br/>")
        : '<li class="italic text-slate-500">Aucun domaine n‚Äôappara√Æt comme prioritaire, mais un √©change qualitatif reste n√©cessaire.</li>';
    }

    // Initialisation
    renderStepDots();
    renderDomain();
  </script>
</body>
</html>
